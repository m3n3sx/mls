{
  "plugin_info": {
    "name": "Modern Admin Styler Enterprise (MASE)",
    "version": "1.3.0",
    "description": "Enterprise-grade WordPress admin styling plugin with visual redesign v2.0 and modern glassmorphism",
    "main_file": "modern-admin-styler.php",
    "last_updated": "2025-10-29",
    "status": "VISUAL REDESIGN v2.0 COMPLETE + Gradient Theme Enhanced"
  },

  "recent_changes": {
    "gradient_theme_enhanced": {
      "file": "assets/css/themes/gradient-theme.css",
      "date": "2025-10-29",
      "description": "Enhanced gradient theme with animated flowing gradients and particle effects",
      "features": [
        "Animated gradient flow on admin bar (10s cycle)",
        "Multi-color gradient on admin menu (12s cycle)",
        "Particle overlay with floating animation",
        "Glassmorphic content area with backdrop blur",
        "Dynamic gradient buttons with hover effects",
        "White text with shadows for readability",
        "Smooth transitions and transforms"
      ],
      "css_animations": [
        "gradientFlow - Background gradient animation",
        "particleFloat - Particle overlay movement"
      ],
      "color_scheme": [
        "#ee7752 (coral)",
        "#e73c7e (pink)",
        "#23a6d5 (blue)",
        "#23d5ab (teal)"
      ]
    }
  },

  "php_files": {
    "core_classes": [
      {
        "file": "includes/class-mase-admin.php",
        "class": "MASE_Admin",
        "lines": 5483,
        "purpose": "Admin interface, asset enqueuing, AJAX handlers, global dark mode",
        "key_methods": [
          "enqueue_assets($hook) - Conditional asset loading for settings page only",
          "enqueue_global_dark_mode($hook) - Global dark mode assets on ALL admin pages",
          "render_global_dark_mode_fab() - Floating action button for dark mode toggle",
          "handle_ajax_toggle_dark_mode() - Dark mode toggle AJAX handler",
          "inject_custom_css() - Injects generated CSS into admin head",
          "handle_ajax_save_settings() - Main settings save with full validation",
          "ajax_apply_palette() - Palette application (bypasses full validation)",
          "ajax_apply_template() - Template application (bypasses full validation)"
        ],
        "asset_enqueue_order": [
          "1. wp-color-picker (CSS + JS)",
          "2. mase-admin.css",
          "3. mase-palettes.css",
          "4. mase-templates.css",
          "5. mase-accessibility.css",
          "6. mase-responsive.css",
          "7. mase-asset-loader.js - MUST LOAD FIRST",
          "8. mase-admin.js - Main script with integrated live preview",
          "9. mase-gradient-builder.js",
          "10. mase-pattern-library.css + .js",
          "11. mase-position-picker.js",
          "12. mase-compatibility.js",
          "13. mase-error-recovery.js",
          "14. mase-background-accessibility.js"
        ],
        "global_dark_mode": {
          "enqueue_hook": "admin_enqueue_scripts (all pages)",
          "render_hook": "admin_footer (all pages)",
          "css_file": "mase-admin.css (reused)",
          "js_file": "mase-global-dark-mode.js",
          "localized_data": "maseGlobalDarkMode (ajaxUrl, nonce)",
          "ajax_action": "mase_toggle_dark_mode",
          "storage": "localStorage (primary) + user_meta (backup)"
        }
      },
      {
        "file": "includes/class-mase-settings.php",
        "class": "MASE_Settings",
        "lines": 7881,
        "purpose": "Settings storage, retrieval, validation, defaults",
        "option_name": "mase_settings",
        "validation": "Full validation in update_option(), bypassed in palette/template apply"
      },
      {
        "file": "includes/class-mase-css-generator.php",
        "class": "MASE_CSS_Generator",
        "lines": 8199,
        "purpose": "Generates CSS from settings with mode-specific caching",
        "performance_target": "<100ms generation time",
        "key_methods": [
          "generate($settings) - Main entry point with mode-specific caching",
          "generate_css_internal($settings) - Internal generation with performance monitoring",
          "generate_admin_bar_css($settings) - Admin bar styling",
          "generate_admin_menu_css($settings) - Admin menu styling",
          "generate_glassmorphism_css($settings) - Modern glassmorphism effects",
          "generate_dark_mode_css($settings) - Dark mode specific styles",
          "generate_google_fonts_import($settings) - Google Fonts @import",
          "generate_palette_css($settings) - Palette CSS variables"
        ],
        "caching": {
          "light_mode_key": "mase_generated_css_light_v1.3.0",
          "dark_mode_key": "mase_generated_css_dark_v1.3.0",
          "cache_duration": "3600 seconds (1 hour)",
          "cache_check": "Checks mode-specific cache first before generation"
        }
      },
      {
        "file": "includes/class-mase-cache.php",
        "class": "MASE_Cache",
        "purpose": "CSS caching using WordPress transients",
        "cache_keys": [
          "mase_generated_css_light_v1.3.0",
          "mase_generated_css_dark_v1.3.0",
          "mase_login_css",
          "mase_button_css"
        ]
      },
      {
        "file": "includes/class-mase-cachemanager.php",
        "class": "MASE_CacheManager",
        "purpose": "Advanced caching with memory cache layer and performance metrics"
      },
      {
        "file": "includes/class-mase-migration.php",
        "class": "MASE_Migration",
        "purpose": "Database migration and settings upgrade"
      },
      {
        "file": "includes/class-mase-mobile-optimizer.php",
        "class": "MASE_Mobile_Optimizer",
        "purpose": "Mobile device detection and graceful degradation"
      },
      {
        "file": "includes/class-mase-rest-api.php",
        "class": "MASE_REST_API",
        "purpose": "REST API endpoint registration and request processing"
      },
      {
        "file": "includes/class-mase-background-migration.php",
        "class": "MASE_Background_Migration",
        "purpose": "Background system migration and structure initialization"
      }
    ],
    "template_files": [
      "includes/admin-settings-page.php - Main admin settings page (5972 lines)",
      "includes/backgrounds-tab-content.php",
      "includes/form-controls-tab-content.php",
      "includes/login-tab-section.php",
      "includes/universal-buttons-tab-content.php",
      "includes/visual-effects-section.php",
      "includes/widgets-tab-content.php",
      "includes/templates/content-tab.php"
    ]
  },

  "js_files": {
    "main_scripts": [
      {
        "file": "assets/js/mase-admin.js",
        "lines": 13776,
        "purpose": "Main admin interface JavaScript with INTEGRATED live preview",
        "dependencies": ["jquery", "wp-color-picker", "mase-asset-loader"],
        "key_modules": [
          "MASE_DEBUG - Debug logging module with console output control",
          "MASE.livePreview - Live preview functionality (INTEGRATED, not separate file)",
          "MASE.darkMode - Dark mode toggle",
          "MASE.paletteManager - Palette management",
          "MASE.templateManager - Template management",
          "MASE.settings - Settings save/load"
        ],
        "critical_note": "Live preview is INTEGRATED into this file to prevent duplicate event handlers. There is NO separate mase-admin-live-preview.js file.",
        "localized_data": "maseL10n (ajaxUrl, nonce, translations)",
        "fouc_prevention": "Inline script before main script checks localStorage and applies dark mode class immediately"
      },
      {
        "file": "assets/js/mase-global-dark-mode.js",
        "lines": 200,
        "purpose": "Global dark mode toggle for ALL WordPress admin pages",
        "dependencies": ["jquery"],
        "features": [
          "FAB click handler",
          "Keyboard shortcut: Ctrl+Shift+D",
          "localStorage persistence (primary)",
          "User meta synchronization (backup)",
          "AJAX save to server",
          "Smooth mode switching with CSS transitions"
        ],
        "localized_data": "maseGlobalDarkMode (ajaxUrl, nonce)",
        "ajax_action": "mase_toggle_dark_mode",
        "initialization": "MASEGlobalDarkMode.init() on document ready"
      },
      {
        "file": "assets/js/mase-accessibility.js",
        "purpose": "Accessibility features (WCAG 2.1 AA compliance)",
        "dependencies": ["jquery"]
      },
      {
        "file": "assets/js/mase-pattern-library.js",
        "purpose": "Pattern library for backgrounds",
        "dependencies": ["jquery", "mase-admin", "mase-asset-loader"]
      },
      {
        "file": "assets/js/mase-position-picker.js",
        "purpose": "Background position picker UI",
        "dependencies": ["jquery", "mase-admin", "mase-asset-loader"]
      }
    ],
    "modules": [
      "assets/js/modules/mase-asset-loader.js - MUST load FIRST (provides utilities)",
      "assets/js/modules/mase-gradient-builder.js - Gradient builder UI",
      "assets/js/modules/mase-compatibility.js - Browser feature detection",
      "assets/js/modules/mase-error-recovery.js - Error recovery mechanisms",
      "assets/js/modules/mase-background-accessibility.js - Background accessibility",
      "assets/js/modules/event-bus.js",
      "assets/js/modules/state-manager.js",
      "assets/js/modules/palette-manager.js",
      "assets/js/modules/template-manager.js",
      "assets/js/modules/preview-engine.js",
      "assets/js/modules/animations.js",
      "assets/js/modules/animation-timeline.js",
      "assets/js/modules/animation-presets.js",
      "assets/js/modules/color-system.js",
      "assets/js/modules/typography.js",
      "assets/js/modules/api-client.js",
      "assets/js/modules/ai-suggestions.js",
      "assets/js/modules/event-adapter.js",
      "assets/js/modules/main-admin.js",
      "assets/js/modules/index.js"
    ],
    "non_existent_files": [
      {
        "file": "assets/js/mase-admin-live-preview.js",
        "status": "DOES NOT EXIST",
        "reason": "Live preview is integrated into mase-admin.js to prevent duplicate event handlers",
        "evidence": "REPOSITORY-MAP-CURRENT.json confirms this architecture"
      }
    ]
  },

  "css_files": {
    "main_stylesheets": [
      {
        "file": "assets/css/mase-admin.css",
        "lines": 1224,
        "purpose": "Main admin interface styles with modern design system v2.0",
        "dependencies": ["wp-color-picker"],
        "design_system": {
          "css_variables": "Comprehensive design token system",
          "color_palette": "Primary, semantic, neutral (10-step gray scale)",
          "spacing_scale": "8-point grid system (4px-48px)",
          "typography": "Font sizes, weights, line heights",
          "border_radius": "6-step scale (4px-9999px)",
          "shadows": "Elevation system (xs-xl)",
          "transitions": "Timing and easing functions",
          "z_index": "Layering scale"
        },
        "dark_mode": {
          "implementation": "CSS custom properties with :root[data-theme='dark']",
          "status": "FULLY IMPLEMENTED",
          "features": [
            "Automatic color inversion",
            "Enhanced shadows for dark backgrounds",
            "Adjusted contrast ratios (WCAG AA compliant)",
            "Smooth transitions"
          ]
        },
        "visual_redesign_v2": {
          "version": "2.0.0",
          "completion_date": "2025-10-29",
          "file_size": "28KB minified",
          "performance": "GPU-accelerated animations",
          "accessibility": "WCAG 2.1 Level AA compliant"
        }
      },
      {
        "file": "assets/css/mase-palettes.css",
        "purpose": "Palette gallery styles",
        "dependencies": ["mase-admin"]
      },
      {
        "file": "assets/css/mase-templates.css",
        "lines": 1000,
        "purpose": "Template gallery styles with modern card design",
        "features": [
          "Responsive grid layout",
          "Modern card components",
          "Hover effects with transforms",
          "Active state indicators",
          "Thumbnail previews",
          "Action buttons"
        ]
      },
      {
        "file": "assets/css/mase-accessibility.css",
        "purpose": "Accessibility enhancements",
        "dependencies": ["mase-admin"]
      },
      {
        "file": "assets/css/mase-responsive.css",
        "purpose": "Responsive design styles",
        "dependencies": ["mase-admin"]
      },
      {
        "file": "assets/css/mase-pattern-library.css",
        "purpose": "Pattern library UI styles"
      },
      {
        "file": "assets/css/mase-animation-editor.css",
        "purpose": "Animation editor UI styles"
      }
    ],
    "theme_files": [
      {
        "file": "assets/css/themes/gradient-theme.css",
        "lines": 139,
        "purpose": "Animated gradient theme with flowing colors",
        "date_enhanced": "2025-10-29",
        "features": [
          "Animated gradient flow (10-12s cycles)",
          "Multi-color gradients (coral, pink, blue, teal)",
          "Particle overlay with floating animation",
          "Glassmorphic content areas",
          "Dynamic gradient buttons",
          "White text with shadows for readability",
          "Smooth hover effects with transforms"
        ],
        "css_custom_properties": {
          "primary_colors": ["#ee7752", "#e73c7e", "#23a6d5", "#23d5ab"],
          "animations": ["gradientFlow", "particleFloat"]
        }
      },
      {
        "file": "assets/css/themes/terminal-theme.css",
        "lines": 136,
        "purpose": "Matrix-style terminal theme",
        "features": [
          "Terminal green (#00ff41) color scheme",
          "Radial gradient background with glow",
          "Monospace fonts (Fira Code, Courier New)",
          "Glowing text shadows and borders",
          "Blinking cursor animation",
          "Terminal glow hover effects"
        ]
      },
      {
        "file": "assets/css/themes/glass-theme.css",
        "purpose": "Modern glassmorphism theme"
      },
      {
        "file": "assets/css/themes/retro-theme.css",
        "purpose": "Retro/vintage aesthetic theme"
      },
      {
        "file": "assets/css/themes/professional-theme.css",
        "purpose": "Clean professional business theme"
      },
      {
        "file": "assets/css/themes/floral-theme.css",
        "purpose": "Nature-inspired floral theme"
      },
      {
        "file": "assets/css/themes/gaming-theme.css",
        "purpose": "Gaming/esports aesthetic theme"
      },
      {
        "file": "assets/css/themes/minimal-theme.css",
        "purpose": "Minimalist clean theme"
      }
    ]
  },

  "test_files": {
    "accessibility_tests": [
      "tests/accessibility/run-all-tests.js - Master test runner",
      "tests/accessibility/contrast-verification.js - WCAG AA contrast testing",
      "tests/accessibility/keyboard-navigation.js - Keyboard accessibility",
      "tests/accessibility/screen-reader-test.js - Screen reader compatibility",
      "tests/accessibility/README.md - Comprehensive test documentation",
      "tests/accessibility/QUICK-REFERENCE.md - Quick testing guide"
    ],
    "performance_tests": [
      "tests/performance/css-animation-performance.html - Animation FPS testing (target: 60fps)"
    ],
    "e2e_tests": [
      "tests/e2e/comprehensive-functionality-test.spec.js",
      "tests/e2e/quick-smoke-test.spec.js",
      "tests/e2e/visual-redesign-regression.spec.js",
      "tests/e2e/browser-compatibility-test.spec.js",
      "tests/e2e/capture-redesign-screenshots.spec.js",
      "tests/e2e/global-setup.js",
      "tests/e2e/helpers/auth.js"
    ],
    "visual_tests": [
      "tests/visual-testing/glassmorphism-2024-verification.html",
      "tests/visual-testing/glassmorphism-2025-test.html"
    ],
    "cypress_tests": [
      "tests/cypress/e2e/mase-basic.cy.js",
      "tests/cypress/support/commands.js",
      "tests/cypress/support/e2e.js"
    ]
  },

  "key_directories": {
    "includes": "PHP backend classes and admin functionality",
    "assets/js": "JavaScript files for admin interface",
    "assets/css": "Stylesheets for admin styling",
    "assets/css/themes": "Theme-specific stylesheets (8 themes available)",
    "tests": "Testing suites (e2e, visual-interactive, accessibility, performance)",
    "docs": "Documentation and guides",
    ".kiro/specs": "Feature specifications and implementation plans"
  },

  "live_preview_architecture": {
    "integration": "INTEGRATED into mase-admin.js as MASE.livePreview module",
    "not_separate_file": true,
    "primary_file": "assets/js/mase-admin.js",
    "module_name": "MASE.livePreview",
    "purpose": "Prevent duplicate event handlers and race conditions",
    "evidence": "[REPOSITORY-MAP-CURRENT.json:line 234-239]"
  },

  "dark_mode_architecture": {
    "status": "FULLY IMPLEMENTED - Global + Settings Page",
    "components": {
      "global_toggle": {
        "file": "assets/js/mase-global-dark-mode.js",
        "scope": "ALL WordPress admin pages",
        "features": ["FAB button", "Keyboard shortcut", "localStorage", "User meta sync"]
      },
      "settings_page": {
        "file": "assets/js/mase-admin.js",
        "scope": "MASE settings page only",
        "features": ["Live preview", "Settings integration", "FOUC prevention"]
      },
      "css": {
        "file": "assets/css/mase-admin.css",
        "implementation": ":root[data-theme='dark']",
        "features": ["Automatic color inversion", "Enhanced shadows", "WCAG AA contrast"]
      },
      "fouc_prevention": {
        "method": "Inline script before mase-admin.js",
        "checks": ["localStorage (primary)", "user_meta (fallback)"],
        "applies": "body.mase-dark-mode class immediately",
        "performance": "<50ms execution time"
      }
    }
  },

  "visual_redesign_status": {
    "version": "2.0.0",
    "status": "COMPLETED",
    "completion_date": "2025-10-29",
    "key_features": [
      "Modern design token system with CSS custom properties",
      "Enhanced glassmorphism with 2025 trends",
      "Full dark mode support with automatic color inversion",
      "WCAG 2.1 Level AA accessibility compliance",
      "Responsive design for all screen sizes",
      "Optimized performance (28KB minified CSS)",
      "GPU-accelerated animations and effects",
      "8 theme variations (gradient, terminal, glass, retro, professional, floral, gaming, minimal)"
    ],
    "documentation": [
      "docs/VISUAL-REDESIGN-CHANGELOG.md",
      "docs/VISUAL-REDESIGN-DEPLOYMENT-SUMMARY.md",
      "docs/VISUAL-REDESIGN-FINAL-REVIEW.md",
      "docs/VISUAL-REDESIGN-ROLLBACK.md",
      ".kiro/specs/visual-redesign-settings-page/"
    ]
  },

  "asset_enqueue_mechanism": {
    "settings_page_only": {
      "hook": "admin_enqueue_scripts",
      "condition": "toplevel_page_mase-settings",
      "method": "enqueue_assets($hook)",
      "file": "includes/class-mase-admin.php",
      "line": 237
    },
    "all_admin_pages": {
      "hook": "admin_enqueue_scripts",
      "method": "enqueue_global_dark_mode($hook)",
      "file": "includes/class-mase-admin.php",
      "line": 156,
      "loads": [
        "mase-admin.css (reused for FAB styles)",
        "mase-global-dark-mode.js"
      ]
    }
  },

  "security_implementation": {
    "nonce_verification": "All AJAX handlers use check_ajax_referer()",
    "capability_checks": "All AJAX handlers verify current_user_can('manage_options')",
    "input_sanitization": "sanitize_text_field(), sanitize_hex_color(), absint()",
    "output_escaping": "esc_html(), esc_attr(), esc_url()",
    "csrf_protection": "Nonces created with wp_create_nonce('mase_save_settings')"
  },

  "critical_notes": {
    "live_preview_integration": "Live preview is INTEGRATED into mase-admin.js, NOT a separate file. This prevents duplicate event handlers.",
    "settings_save_system": "Palette/template apply bypass full validation. Main form save uses full validation. DO NOT MODIFY without reading user-rule 8.md",
    "dark_mode_scope": "Global dark mode works on ALL admin pages. Settings page has additional dark mode features.",
    "asset_loading_order": "mase-asset-loader.js MUST load before other modules as it provides utilities.",
    "theme_system": "8 theme files available in assets/css/themes/ - gradient theme recently enhanced with animations"
  }
}
