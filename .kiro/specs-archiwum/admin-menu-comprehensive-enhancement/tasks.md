# Implementation Plan

- [x] 1. Extend settings data structure for admin menu enhancements
  - Add new properties to `$settings['admin_menu']` array for gradient backgrounds, padding controls, icon colors, border radius, floating margins, shadows, and logo
  - Add new `$settings['admin_menu_submenu']` array for submenu styling and typography
  - Update `$settings['typography']['admin_menu']` with font family support
  - Implement default values for backward compatibility
  - _Requirements: 1.2, 2.3, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1, 16.1_

- [x] 2. Fix Height Mode persistence issue
  - [x] 2.1 Update settings save method to properly store height_mode value
    - Validate height_mode is either 'full' or 'content'
    - Ensure value is saved to database
    - _Requirements: 4.1, 4.2_
  - [x] 2.2 Update settings load method to retrieve height_mode
    - Load height_mode from database
    - Apply default value if not set
    - _Requirements: 4.2, 4.3_
  - [x] 2.3 Update CSS generator to apply Height Mode styles
    - Generate CSS for 'full' mode (height: 100%)
    - Generate CSS for 'content' mode (height: auto, min-height: 100vh)
    - _Requirements: 4.4_

- [x] 3. Implement menu item padding optimization
  - [x] 3.1 Add padding controls to settings UI
    - Add vertical padding slider (5-30px)
    - Add horizontal padding slider (5-30px)
    - _Requirements: 1.2, 1.3_
  - [x] 3.2 Generate padding CSS in CSS generator
    - Create `generate_menu_item_padding_css()` method
    - Apply padding to `#adminmenu li.menu-top > a`
    - _Requirements: 1.1, 1.4, 1.5_
  - [x] 3.3 Add live preview for padding changes
    - Listen to padding slider changes
    - Update menu item padding in real-time
    - _Requirements: 1.4_

- [x] 4. Implement icon color synchronization
  - [x] 4.1 Add icon color controls to settings UI
    - Add icon color mode toggle (auto/custom)
    - Add custom icon color picker (conditional)
    - _Requirements: 2.3_
  - [x] 4.2 Generate icon color CSS
    - Create `generate_menu_icon_color_css()` method
    - Sync icon color with text color in auto mode
    - Apply custom color in custom mode
    - _Requirements: 2.1, 2.2_
  - [x] 4.3 Add live preview for icon color
    - Update icon colors when text color changes (auto mode)
    - Update icon colors when custom color changes
    - _Requirements: 2.1, 4.4_

- [x] 5. Fix dynamic submenu positioning
  - [x] 5.1 Update CSS generator for submenu positioning
    - Create `generate_submenu_positioning_css()` method
    - Calculate left position based on menu width
    - Apply spacing offset
    - _Requirements: 3.1, 3.2, 3.3, 3.4_
  - [x] 5.2 Add live preview for submenu positioning
    - Recalculate submenu position when width changes
    - Update submenu position when spacing changes
    - _Requirements: 3.5_

- [x] 6. Implement live preview for all visual effects
  - [x] 6.1 Add live preview for Height Mode
    - Listen to height mode select changes
    - Apply height styles in real-time
    - _Requirements: 5.1_
  - [x] 6.2 Add live preview for glassmorphism
    - Listen to glassmorphism toggle
    - Apply glassmorphism effects in real-time
    - _Requirements: 5.2_
  - [x] 6.3 Add live preview for blur intensity
    - Listen to blur slider changes
    - Update blur effect in real-time
    - _Requirements: 5.3_
  - [x] 6.4 Add live preview for border radius
    - Listen to border radius changes
    - Update corner rounding in real-time
    - _Requirements: 5.4_
  - [x] 6.5 Add live preview for shadow preset
    - Listen to shadow preset changes
    - Apply shadow styles in real-time
    - _Requirements: 5.5_
  - [x] 6.6 Add live preview for floating mode
    - Listen to floating toggle
    - Apply floating margins in real-time
    - _Requirements: 5.6_
  - [x] 6.7 Add live preview for floating margins
    - Listen to margin slider changes
    - Update menu positioning in real-time
    - _Requirements: 5.7_

- [x] 7. Implement gradient background support
  - [x] 7.1 Add gradient controls to settings UI
    - Add background type toggle (solid/gradient)
    - Add gradient type selector (linear/radial/conic)
    - Add gradient angle slider (0-360Â°)
    - Add color stop pickers (minimum 2)
    - _Requirements: 6.1, 6.2, 6.4_
  - [x] 7.2 Generate gradient CSS
    - Create `generate_gradient_background()` method for menu
    - Support linear, radial, and conic gradients
    - Handle color stops and angles
    - _Requirements: 6.1, 6.2, 6.4_
  - [x] 7.3 Add live preview for gradients
    - Update gradient when type changes
    - Update gradient when angle changes
    - Update gradient when colors change
    - _Requirements: 6.3, 6.5_

- [x] 8. Implement submenu background customization
  - [x] 8.1 Add submenu background color control
    - Add color picker for submenu background
    - _Requirements: 7.1_
  - [x] 8.2 Generate submenu background CSS
    - Apply background color to `#adminmenu .wp-submenu`
    - _Requirements: 7.1, 7.3_
  - [x] 8.3 Add live preview for submenu background
    - Update submenu background in real-time
    - _Requirements: 7.2, 7.4_

- [x] 9. Implement submenu border radius controls
  - [x] 9.1 Add submenu border radius controls
    - Add uniform/individual mode toggle
    - Add radius sliders (0-20px)
    - _Requirements: 8.1, 8.2_
  - [x] 9.2 Generate submenu border radius CSS
    - Apply uniform or individual corner radius
    - _Requirements: 8.1_
  - [x] 9.3 Add live preview for submenu border radius
    - Update submenu corners in real-time
    - _Requirements: 8.4_

- [x] 10. Implement submenu spacing controls
  - [x] 10.1 Add submenu spacing slider
    - Add spacing control (0-50px)
    - _Requirements: 9.1_
  - [x] 10.2 Generate submenu spacing CSS
    - Apply vertical offset to submenus
    - _Requirements: 9.2_
  - [x] 10.3 Add live preview for submenu spacing
    - Update submenu position in real-time
    - _Requirements: 9.3, 9.4_

- [x] 11. Implement submenu typography controls
  - [x] 11.1 Add submenu typography controls to UI
    - Add font size control (10-24px)
    - Add text color picker
    - Add line height slider (1.0-3.0)
    - Add letter spacing slider (-2 to 5px)
    - Add text transform selector
    - _Requirements: 10.1, 10.2, 10.3, 10.4, 10.5_
  - [x] 11.2 Generate submenu typography CSS
    - Create `generate_menu_submenu_css()` method
    - Apply all typography styles to submenu items
    - _Requirements: 10.1, 10.2, 10.3, 10.4, 10.5_
  - [x] 11.3 Add live preview for submenu typography
    - Update submenu text styling in real-time
    - _Requirements: 10.6_

- [x] 12. Implement Google Fonts integration
  - [x] 12.1 Add font family selectors to UI
    - Add menu font family selector with system and Google Fonts
    - Add submenu font family selector
    - Include at least 10 popular Google Fonts
    - _Requirements: 11.1, 11.4, 11.6_
  - [x] 12.2 Implement Google Fonts loading
    - Create `loadGoogleFont()` JavaScript method
    - Load fonts dynamically without page reload
    - Handle loading errors with fallbacks
    - _Requirements: 11.2, 11.5_
  - [x] 12.3 Add live preview for font family
    - Apply font when selection changes
    - Load Google Font if selected
    - _Requirements: 11.3_
  - [x] 12.4 Generate Google Fonts @import CSS
    - Create `generate_google_fonts_import()` method
    - Add @import statements for selected fonts
    - _Requirements: 11.2, 11.5_

- [x] 13. Implement individual corner radius controls
  - [x] 13.1 Add corner radius controls to UI
    - Add uniform/individual mode toggle
    - Add four separate sliders for individual corners (0-50px)
    - Add single slider for uniform mode (0-50px)
    - _Requirements: 12.1, 12.2, 12.3, 12.4_
  - [x] 13.2 Generate corner radius CSS
    - Create `generate_border_radius_css()` method for menu
    - Support uniform and individual corner modes
    - _Requirements: 12.1, 12.2, 12.3_
  - [x] 13.3 Add live preview for corner radius
    - Update menu corners in real-time
    - _Requirements: 12.5_

- [x] 14. Implement advanced shadow controls
  - [x] 14.1 Add shadow controls to UI
    - Add preset/custom mode toggle
    - Add shadow preset selector (5 presets)
    - Add custom shadow controls (offset, blur, spread, color, opacity)
    - _Requirements: 13.1, 13.2, 13.3, 13.4_
  - [x] 14.2 Generate shadow CSS
    - Create `generate_shadow_css()` method for menu
    - Support preset and custom shadow modes
    - _Requirements: 13.1, 13.2, 13.3_
  - [x] 14.3 Add live preview for shadows
    - Update menu shadow in real-time
    - _Requirements: 13.5_

- [x] 15. Implement menu width controls
  - [x] 15.1 Update width control in UI
    - Modify existing width control to support pixels and percentage
    - Add unit toggle (pixels/percentage)
    - Add appropriate slider ranges
    - _Requirements: 14.1, 14.2, 14.3_
  - [x] 15.2 Generate width CSS
    - Create `generate_width_css()` method for menu
    - Support both pixel and percentage units
    - _Requirements: 14.1, 14.2, 14.3_
  - [x] 15.3 Update live preview for width
    - Recalculate submenu positioning when width changes
    - Adjust content area margin
    - _Requirements: 14.4, 14.5_

- [x] 16. Implement individual floating margin controls
  - [x] 16.1 Add floating margin controls to UI
    - Add uniform/individual mode toggle
    - Add four separate sliders for individual margins (0-100px)
    - Add single slider for uniform mode (0-100px)
    - _Requirements: 15.1, 15.2, 15.3, 15.4_
  - [x] 16.2 Generate floating margin CSS
    - Create `generate_floating_css()` method for menu
    - Support uniform and individual margin modes
    - _Requirements: 15.1, 15.2, 15.3_
  - [x] 16.3 Add live preview for floating margins
    - Update menu positioning in real-time
    - _Requirements: 15.5_

- [x] 17. Implement logo placement functionality
  - [x] 17.1 Add logo upload and controls to UI
    - Add logo enable toggle
    - Add logo upload button with file picker
    - Add logo position selector (top/bottom)
    - Add logo width slider (20-200px)
    - Add logo alignment selector (left/center/right)
    - _Requirements: 16.1, 16.2, 16.3, 16.4_
  - [x] 17.2 Implement logo upload handler
    - Create AJAX handler for logo upload
    - Validate file type (PNG, JPG, SVG)
    - Validate file size (max 2MB)
    - Sanitize SVG content
    - Store logo URL in settings
    - _Requirements: 16.1_
  - [x] 17.3 Generate logo CSS
    - Create `generate_menu_logo_css()` method
    - Position logo at top or bottom
    - Apply alignment and sizing
    - _Requirements: 16.2, 16.3, 16.4, 16.8_
  - [x] 17.4 Add live preview for logo
    - Display logo when uploaded
    - Update position when changed
    - Update size when changed
    - Update alignment when changed
    - _Requirements: 16.5, 16.6_
  - [x] 17.5 Add logo removal functionality
    - Add remove logo button
    - Clear logo URL from settings
    - Hide logo in preview
    - _Requirements: 16.7_

- [x] 18. Update settings save and load methods
  - [x] 18.1 Update MASE_Settings::save_settings()
    - Add validation for all new menu settings
    - Sanitize all inputs properly
    - Ensure Height Mode is saved correctly
    - _Requirements: 4.1, All requirements_
  - [x] 18.2 Update MASE_Settings::get_settings()
    - Load all new menu settings
    - Apply default values for missing settings
    - Ensure Height Mode is loaded correctly
    - _Requirements: 4.2, All requirements_

- [x] 19. Create comprehensive CSS generator methods
  - [x] 19.1 Update generate_admin_menu_css() main method
    - Integrate all new CSS generation methods
    - Ensure proper CSS structure and organization
    - _Requirements: All requirements_
  - [x] 19.2 Implement helper methods
    - `generate_gradient_background()` for menu
    - `generate_menu_item_padding_css()`
    - `generate_menu_icon_color_css()`
    - `generate_submenu_positioning_css()`
    - `generate_height_mode_css()`
    - `generate_menu_submenu_css()`
    - `generate_menu_logo_css()`
    - `generate_border_radius_css()` for menu
    - `generate_shadow_css()` for menu
    - `generate_floating_css()` for menu
    - _Requirements: All requirements_

- [x] 20. Implement complete live preview system
  - [x] 20.1 Create adminMenuPreview module in mase-admin.js
    - Initialize all event listeners
    - Implement all update methods
    - Handle errors gracefully
    - _Requirements: All requirements_
  - [x] 20.2 Implement specific update methods
    - `updateWidth()` with submenu recalculation
    - `updateTextAndIconColor()` with synchronization
    - `updateHeightMode()`
    - `updateSubmenuSpacing()`
    - `updatePadding()`
    - `loadGoogleFont()`
    - `updateLogoVisibility()`
    - `updateLogoPosition()`
    - All other visual effect methods
    - _Requirements: All requirements_

- [x] 21. Add conditional field visibility
  - [x] 21.1 Implement conditional display for gradient controls
    - Show gradient controls when bg_type is 'gradient'
    - Hide when 'solid'
    - _Requirements: 6.5_
  - [x] 21.2 Implement conditional display for icon color
    - Show custom icon color when mode is 'custom'
    - Hide when 'auto'
    - _Requirements: 2.3_
  - [x] 21.3 Implement conditional display for corner radius
    - Show individual controls when mode is 'individual'
    - Show uniform control when mode is 'uniform'
    - _Requirements: 12.2, 12.3_
  - [x] 21.4 Implement conditional display for floating margins
    - Show individual controls when mode is 'individual'
    - Show uniform control when mode is 'uniform'
    - _Requirements: 15.2, 15.3_
  - [x] 21.5 Implement conditional display for shadows
    - Show preset selector when mode is 'preset'
    - Show custom controls when mode is 'custom'
    - _Requirements: 13.4_
  - [x] 21.6 Implement conditional display for logo controls
    - Show logo controls when logo is enabled
    - Hide when disabled
    - _Requirements: 16.1_

- [x] 22. Implement security measures
  - [x] 22.1 Add input validation and sanitization
    - Validate all numeric ranges
    - Sanitize color values
    - Sanitize text inputs
    - Validate enum values
    - _Requirements: All requirements_
  - [x] 22.2 Add file upload security
    - Validate file types
    - Validate file sizes
    - Sanitize SVG content
    - Check user capabilities
    - _Requirements: 16.1_
  - [x] 22.3 Add CSRF protection
    - Verify nonces on all AJAX requests
    - Check user capabilities
    - _Requirements: All requirements_

- [x] 23. Add error handling
  - [x] 23.1 Add CSS generation error handling
    - Try-catch blocks
    - Fallback to cached CSS
    - Error logging
    - _Requirements: All requirements_
  - [x] 23.2 Add JavaScript error handling
    - Try-catch in live preview methods
    - User-friendly error messages
    - Console error logging
    - _Requirements: All requirements_
  - [x] 23.3 Add Google Font loading error handling
    - Fallback fonts
    - Error notifications
    - _Requirements: 11.2_
  - [x] 23.4 Add logo upload error handling
    - Validation error messages
    - Upload failure handling
    - _Requirements: 16.1_

- [x] 24. Update documentation
  - [x] 24.1 Update user guide
    - Document menu spacing optimization
    - Document gradient backgrounds
    - Document Google Fonts selection
    - Document submenu customization
    - Document logo placement
    - Document Height Mode fix
    - _Requirements: All requirements_
  - [x] 24.2 Update developer guide
    - Document CSS generation architecture
    - Document live preview system
    - Document logo upload process
    - _Requirements: All requirements_
  - [x] 24.3 Update troubleshooting guide
    - Add Height Mode persistence troubleshooting
    - Add submenu positioning troubleshooting
    - Add Google Font loading troubleshooting
    - Add logo upload troubleshooting
    - _Requirements: 4.1, 3.1, 11.2, 16.1_

- [x] 25. Create comprehensive test suite
  - [x] 25.1 Create unit tests for CSS generator
    - Test all new CSS generation methods
    - Test gradient CSS output
    - Test submenu positioning calculation
    - Test Height Mode CSS output
    - _Requirements: All requirements_
  - [x] 25.2 Create integration tests
    - Test settings save/load with all new fields
    - Test Height Mode persistence
    - Test live preview for all controls
    - Test submenu positioning updates
    - _Requirements: All requirements_
  - [x] 25.3 Create visual tests
    - Test menu item spacing
    - Test submenu positioning at different widths
    - Test Height Mode visual changes
    - Test logo display and positioning
    - _Requirements: 1.1, 3.1, 4.1, 16.5_
  - [x] 25.4 Create browser compatibility tests
    - Test on Chrome, Firefox, Safari, Edge
    - Test all live preview functionality
    - Test Google Font loading
    - _Requirements: All requirements_
