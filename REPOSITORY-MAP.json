{
  "repository_structure": {
    "php_files": {
      "core": [
        "modern-admin-styler.php"
      ],
      "includes": [
        "includes/class-mase-admin.php",
        "includes/class-mase-settings.php",
        "includes/class-mase-css-generator.php",
        "includes/class-mase-cache.php",
        "includes/class-mase-cachemanager.php",
        "includes/class-mase-migration.php",
        "includes/class-mase-mobile-optimizer.php",
        "includes/class-mase-rest-api.php",
        "includes/class-mase-background-migration.php"
      ],
      "templates": [
        "includes/admin-settings-page.php",
        "includes/backgrounds-tab-content.php",
        "includes/form-controls-tab-content.php",
        "includes/login-tab-section.php",
        "includes/universal-buttons-tab-content.php",
        "includes/visual-effects-section.php",
        "includes/widgets-tab-content.php",
        "includes/templates/content-tab.php"
      ]
    },
    "js_files": {
      "main": [
        "assets/js/mase-admin.js",
        "assets/js/mase-accessibility.js",
        "assets/js/mase-pattern-library.js",
        "assets/js/mase-position-picker.js"
      ],
      "modules": [
        "assets/js/modules/ai-suggestions.js",
        "assets/js/modules/animation-editor-example.js",
        "assets/js/modules/animation-presets.js",
        "assets/js/modules/animation-timeline.js",
        "assets/js/modules/animations.js",
        "assets/js/modules/api-client-example.js",
        "assets/js/modules/api-client.js",
        "assets/js/modules/color-system.js",
        "assets/js/modules/event-adapter.js",
        "assets/js/modules/event-bus.js",
        "assets/js/modules/index.js",
        "assets/js/modules/main-admin.js",
        "assets/js/modules/mase-asset-loader.js",
        "assets/js/modules/mase-background-accessibility.js",
        "assets/js/modules/mase-compatibility.js",
        "assets/js/modules/mase-error-recovery.js",
        "assets/js/modules/mase-gradient-builder.js",
        "assets/js/modules/palette-manager.js",
        "assets/js/modules/preview-engine.js",
        "assets/js/modules/state-manager.js",
        "assets/js/modules/template-manager.js",
        "assets/js/modules/typography.js"
      ]
    },
    "css_files": [
      "assets/css/mase-admin.css",
      "assets/css/mase-accessibility.css",
      "assets/css/mase-animation-editor.css",
      "assets/css/mase-palettes.css",
      "assets/css/mase-pattern-library.css",
      "assets/css/mase-responsive.css",
      "assets/css/mase-templates.css"
    ],
    "test_files": {
      "visual_interactive": "tests/visual-interactive/**/*",
      "e2e": "tests/e2e/**/*",
      "cypress": "tests/cypress/**/*",
      "katalon": "katalon-tests/**/*",
      "benchmarks": "tests/benchmarks/**/*"
    },
    "key_directories": {
      "includes": "PHP backend classes and admin functionality",
      "assets/js": "JavaScript files for admin interface and live preview",
      "assets/js/modules": "Modular JavaScript components (gradient builder, asset loader, etc.)",
      "assets/css": "Stylesheets for admin styling and themes",
      "tests": "Testing suites including visual, integration, and browser tests",
      "docs": "Documentation, guides, and implementation summaries",
      "scripts": "Build, deployment, and validation scripts",
      "languages": "Translation files (POT, PO, MO)"
    }
  },
  "asset_enqueue_mechanism": {
    "location": "includes/class-mase-admin.php",
    "method": "enqueue_assets()",
    "hook": "admin_enqueue_scripts",
    "conditional_loading": "Only loads on 'toplevel_page_mase-settings' hook",
    "dependencies": {
      "css": {
        "mase-admin": ["wp-color-picker"],
        "mase-palettes": ["mase-admin"],
        "mase-templates": ["mase-admin"],
        "mase-accessibility": ["mase-admin"],
        "mase-responsive": ["mase-admin"],
        "mase-pattern-library": []
      },
      "js": {
        "mase-asset-loader": ["jquery"],
        "mase-admin": ["jquery", "wp-color-picker", "mase-asset-loader"],
        "mase-gradient-builder": ["jquery", "wp-color-picker", "mase-admin", "mase-asset-loader"],
        "mase-pattern-library": ["jquery", "mase-admin", "mase-asset-loader"],
        "mase-position-picker": ["jquery", "mase-admin", "mase-asset-loader"],
        "mase-compatibility": ["jquery"],
        "mase-error-recovery": ["jquery", "mase-admin"],
        "mase-background-accessibility": ["jquery", "mase-admin", "mase-gradient-builder", "mase-pattern-library", "mase-position-picker"]
      }
    },
    "localization": {
      "maseL10n": {
        "purpose": "Dark mode translations and UI strings",
        "includes": ["ajaxUrl", "nonce", "dark mode strings", "error messages"]
      },
      "maseAdmin": {
        "purpose": "Main admin configuration and data",
        "includes": ["ajaxUrl", "nonce", "debug", "palettes", "templates", "gradientPresets", "strings"]
      },
      "masePatternLibrary": {
        "purpose": "Pattern library data",
        "includes": "Pattern library configuration"
      }
    },
    "inline_scripts": {
      "dark_mode_fouc_prevention": {
        "position": "before mase-admin",
        "purpose": "Prevent Flash of Unstyled Content by applying dark mode class synchronously",
        "execution_time": "<50ms",
        "requirements": ["12.1", "12.2", "12.3", "12.4"]
      }
    },
    "inline_styles": {
      "dashicons_pointer_events_fix": {
        "purpose": "Fix dashicons blocking toggle clicks",
        "critical": true,
        "applies_to": ["Live Preview toggle", "Dark Mode toggle"]
      }
    }
  },
  "ajax_handlers": {
    "core_settings": [
      "wp_ajax_mase_save_settings",
      "wp_ajax_mase_export_settings",
      "wp_ajax_mase_import_settings",
      "wp_ajax_mase_reset_settings"
    ],
    "palettes": [
      "wp_ajax_mase_apply_palette",
      "wp_ajax_mase_save_custom_palette",
      "wp_ajax_mase_delete_custom_palette"
    ],
    "templates": [
      "wp_ajax_mase_apply_template",
      "wp_ajax_mase_save_custom_template",
      "wp_ajax_mase_delete_custom_template"
    ],
    "backups": [
      "wp_ajax_mase_create_backup",
      "wp_ajax_mase_restore_backup",
      "wp_ajax_mase_get_backups"
    ],
    "uploads": [
      "wp_ajax_mase_upload_menu_logo",
      "wp_ajax_mase_upload_login_logo",
      "wp_ajax_mase_upload_login_background",
      "wp_ajax_mase_upload_background_image",
      "wp_ajax_mase_select_background_image",
      "wp_ajax_mase_remove_background_image"
    ],
    "features": [
      "wp_ajax_mase_get_pattern_library",
      "wp_ajax_mase_toggle_dark_mode",
      "wp_ajax_mase_log_client_error"
    ],
    "buttons": [
      "wp_ajax_mase_get_button_defaults",
      "wp_ajax_mase_reset_button_type",
      "wp_ajax_mase_reset_all_buttons"
    ]
  },
  "security_implementation": {
    "csrf_protection": {
      "nonce_action": "mase_save_settings",
      "verification": "check_ajax_referer()",
      "all_ajax_handlers": "Verify nonce before processing"
    },
    "authorization": {
      "capability": "manage_options",
      "check": "current_user_can('manage_options')",
      "all_ajax_handlers": "Check capability before processing"
    },
    "input_sanitization": {
      "text": "sanitize_text_field()",
      "colors": "sanitize_hex_color()",
      "arrays": "array_map() with sanitization",
      "validation": "MASE_Settings::validate()"
    },
    "output_escaping": {
      "html": "esc_html()",
      "attributes": "esc_attr()",
      "urls": "esc_url()",
      "javascript": "esc_js()"
    }
  },
  "performance_optimization": {
    "caching": {
      "css_cache": {
        "key": "mase_generated_css",
        "duration": "3600 seconds (1 hour)",
        "invalidation": "On settings save",
        "warm_cache": "Pre-generate for both light and dark modes"
      },
      "mode_caches": {
        "light": "Cached separately",
        "dark": "Cached separately",
        "invalidation": "Both invalidated on settings save"
      }
    },
    "conditional_loading": {
      "admin_page_only": "Assets only load on MASE settings page",
      "lazy_loading": "Modules loaded on demand by asset loader"
    },
    "minification": {
      "css": "Optional minification via settings",
      "enabled_check": "settings['performance']['enable_minification']"
    }
  },
  "live_preview_system": {
    "note": "Live preview functionality is handled by MASE.livePreview module in assets/js/mase-admin.js",
    "location": "assets/js/mase-admin.js",
    "purpose": "Prevent duplicate event handlers and race conditions",
    "integration": "All live preview functionality consolidated in main admin script"
  },
  "dark_mode_system": {
    "fouc_prevention": {
      "method": "Inline script before main script",
      "checks": ["localStorage", "user meta", "default to light"],
      "execution": "Synchronous, <50ms",
      "class_applied": "mase-dark-mode on body"
    },
    "ajax_handler": "wp_ajax_mase_toggle_dark_mode",
    "cache_strategy": "Separate caches for light and dark modes",
    "persistence": ["localStorage", "user meta"]
  },
  "background_system": {
    "types": ["solid", "gradient", "image", "pattern"],
    "modules": [
      "mase-gradient-builder.js",
      "mase-pattern-library.js",
      "mase-position-picker.js"
    ],
    "ajax_handlers": [
      "upload_background_image",
      "select_background_image",
      "remove_background_image",
      "get_pattern_library"
    ],
    "accessibility": "mase-background-accessibility.js"
  },
  "production_deployment_tasks": {
    "phase_1_validation": {
      "code_quality": ["WPCS", "PHP syntax", "ESLint", "complexity", "PHPDoc"],
      "security": ["vulnerability scan", "nonce audit", "sanitization audit", "escaping audit", "SQL audit"],
      "performance": ["CSS generation benchmark", "settings save benchmark", "memory profiler", "cache performance"],
      "compatibility": ["WordPress versions", "PHP versions", "MySQL versions", "browsers", "multisite"],
      "tests": ["E2E tests", "unit tests", "visual regression"]
    },
    "phase_2_package": {
      "version_management": ["update version", "CHANGELOG", "Git tag"],
      "build": ["production build", "bundle sizes", "source maps", "build report"],
      "documentation": ["readme.txt", "screenshots", "links", "upgrade notice"],
      "assembly": ["package script", "ZIP file", "size validation", "installation test"]
    },
    "phase_3_submission": {
      "svn": ["checkout", "update trunk", "create tag", "commit"],
      "assets": ["screenshots", "banners", "icons"],
      "verification": ["files uploaded", "download test", "readme display"]
    },
    "phase_4_monitoring": {
      "setup": ["error logging", "performance monitoring", "security audit logging", "dashboard"],
      "communication": ["release announcement", "website update", "support docs"],
      "rollback": ["procedure documentation", "rollback test", "previous version backup", "triggers"]
    },
    "phase_5_signoff": {
      "validation": ["complete validation suite", "all tests pass", "compatibility verified", "documentation complete"],
      "deployment": ["checklist", "stakeholder approval", "schedule"]
    }
  },
  "benchmark_implementation": {
    "css_generation": {
      "file": "tests/benchmarks/css-generation.php",
      "target": "<100ms",
      "method": "generate_css()",
      "iterations": 10,
      "metrics": ["average", "min", "max", "CSS size"]
    }
  }
}
