<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MASE - Scroll Position Stability Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
            margin: 0;
            padding: 20px;
            background: #f0f0f1;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #1d2327;
            margin-top: 0;
        }
        
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #f9f9f9;
            border-left: 4px solid #2271b1;
            border-radius: 4px;
        }
        
        .test-section h2 {
            margin-top: 0;
            color: #2271b1;
        }
        
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .test-result.pass {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .test-result.fail {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .test-result.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        button {
            background: #2271b1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        
        button:hover {
            background: #135e96;
        }
        
        button:focus {
            outline: 2px solid #2271b1;
            outline-offset: 2px;
        }
        
        input, select, textarea {
            padding: 8px;
            border: 1px solid #8c8f94;
            border-radius: 4px;
            margin: 5px;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #2271b1;
        }
        
        input:focus-visible, select:focus-visible, textarea:focus-visible {
            outline: 2px solid #2271b1;
            outline-offset: 2px;
        }
        
        .spacer {
            height: 1500px;
            background: linear-gradient(to bottom, #f0f0f1 0%, #ffffff 100%);
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 18px;
        }
        
        .tab-container {
            display: flex;
            border-bottom: 1px solid #c3c4c7;
            margin-bottom: 20px;
        }
        
        .tab-button {
            padding: 10px 20px;
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            color: #50575e;
        }
        
        .tab-button.active {
            color: #2271b1;
            border-bottom-color: #2271b1;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 4px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .focus-test-area {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        #scroll-position {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #2271b1;
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            font-weight: 500;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div id="scroll-position">Scroll: 0px</div>
    
    <div class="test-container">
        <h1>ðŸ§ª MASE Scroll Position Stability Test</h1>
        <p>This test verifies Requirements 7.1, 7.2, 7.3, 7.4, 7.5 for scroll position stability and focus ring removal.</p>
        
        <!-- Test 1: Page Load Scroll Stability -->
        <div class="test-section">
            <h2>Test 1: No Scroll Jump on Page Load</h2>
            <p><strong>Requirement 7.1:</strong> Verify no scroll jump on page load</p>
            <div id="test1-result" class="test-result info">
                Test will run automatically on page load...
            </div>
            <p><strong>Instructions:</strong></p>
            <ol>
                <li>Scroll down to the middle of the page</li>
                <li>Refresh the page (F5 or Ctrl+R)</li>
                <li>Observe if the page maintains scroll position or jumps</li>
            </ol>
        </div>
        
        <!-- Test 2: Focus Ring Removal -->
        <div class="test-section">
            <h2>Test 2: No Blue Rings After Mouse Clicks</h2>
            <p><strong>Requirement 7.2, 7.3:</strong> Verify no blue rings after mouse clicks</p>
            <div id="test2-result" class="test-result info">
                Click the buttons and inputs below to test...
            </div>
            <div class="focus-test-area">
                <button id="test-button-1">Click Me</button>
                <button id="test-button-2">Click Me Too</button>
                <input type="text" placeholder="Click and type" id="test-input-1">
                <select id="test-select-1">
                    <option>Option 1</option>
                    <option>Option 2</option>
                </select>
                <textarea placeholder="Click and type" id="test-textarea-1"></textarea>
            </div>
            <p><strong>Instructions:</strong></p>
            <ol>
                <li>Click each button, input, select, and textarea above</li>
                <li>Verify NO blue focus ring appears after clicking</li>
                <li>If you see a blue ring, the test FAILS</li>
            </ol>
            <button onclick="checkFocusRings()">Check Focus Rings</button>
        </div>
        
        <!-- Test 3: Keyboard Navigation Focus -->
        <div class="test-section">
            <h2>Test 3: Keyboard Navigation Shows Focus</h2>
            <p><strong>Requirement 7.3, 7.5:</strong> Verify keyboard navigation still shows focus</p>
            <div id="test3-result" class="test-result info">
                Use Tab key to navigate...
            </div>
            <div class="focus-test-area">
                <button id="test-kb-button-1">Tab to Me</button>
                <button id="test-kb-button-2">Then to Me</button>
                <input type="text" placeholder="Then to me" id="test-kb-input-1">
                <select id="test-kb-select-1">
                    <option>Option 1</option>
                    <option>Option 2</option>
                </select>
            </div>
            <p><strong>Instructions:</strong></p>
            <ol>
                <li>Press Tab key to navigate through the elements above</li>
                <li>Verify a visible focus indicator appears (outline or box-shadow)</li>
                <li>If you see NO focus indicator, the test FAILS</li>
            </ol>
            <button onclick="checkKeyboardFocus()">Verify Keyboard Focus Works</button>
        </div>
        
        <!-- Spacer for scrolling -->
        <div class="spacer">
            Scroll down to test tab switching...
        </div>
        
        <!-- Test 4: Tab Switching Scroll Stability -->
        <div class="test-section">
            <h2>Test 4: Tab Switching Maintains Scroll Position</h2>
            <p><strong>Requirement 7.1, 7.4:</strong> Test tab switching maintains scroll position</p>
            <div id="test4-result" class="test-result info">
                Switch tabs to test...
            </div>
            
            <div class="tab-container">
                <button class="tab-button active" data-tab="tab1">Tab 1</button>
                <button class="tab-button" data-tab="tab2">Tab 2</button>
                <button class="tab-button" data-tab="tab3">Tab 3</button>
            </div>
            
            <div class="tab-content active" data-tab-content="tab1">
                <h3>Tab 1 Content</h3>
                <p>This is the content of Tab 1.</p>
            </div>
            
            <div class="tab-content" data-tab-content="tab2">
                <h3>Tab 2 Content</h3>
                <p>This is the content of Tab 2.</p>
            </div>
            
            <div class="tab-content" data-tab-content="tab3">
                <h3>Tab 3 Content</h3>
                <p>This is the content of Tab 3.</p>
            </div>
            
            <p><strong>Instructions:</strong></p>
            <ol>
                <li>Scroll to this section (you should be here now)</li>
                <li>Note your current scroll position (shown in top-right corner)</li>
                <li>Click different tabs above</li>
                <li>Verify the scroll position does NOT change</li>
                <li>If the page jumps or scrolls, the test FAILS</li>
            </ol>
            <button onclick="runTabSwitchTest()">Run Automated Tab Switch Test</button>
        </div>
        
        <!-- Another spacer -->
        <div class="spacer">
            More content for scrolling...
        </div>
        
        <!-- Summary -->
        <div class="test-section">
            <h2>Test Summary</h2>
            <div id="summary-result" class="test-result info">
                Complete all tests above to see summary...
            </div>
            <button onclick="generateSummary()">Generate Test Summary</button>
        </div>
    </div>
    
    <script>
        // Track scroll position
        window.addEventListener('scroll', function() {
            document.getElementById('scroll-position').textContent = 'Scroll: ' + Math.round(window.scrollY) + 'px';
        });
        
        // Test 1: Page load scroll stability
        window.addEventListener('load', function() {
            // Store scroll position before any initialization
            var initialScroll = window.scrollY;
            
            // Simulate initialization
            setTimeout(function() {
                var finalScroll = window.scrollY;
                var scrollDiff = Math.abs(finalScroll - initialScroll);
                
                var result = document.getElementById('test1-result');
                if (scrollDiff < 5) {
                    result.className = 'test-result pass';
                    result.textContent = 'âœ“ PASS: No scroll jump detected (diff: ' + scrollDiff + 'px)';
                } else {
                    result.className = 'test-result fail';
                    result.textContent = 'âœ— FAIL: Scroll jump detected (diff: ' + scrollDiff + 'px)';
                }
            }, 100);
        });
        
        // Test 2: Focus ring removal
        function checkFocusRings() {
            var result = document.getElementById('test2-result');
            result.className = 'test-result info';
            result.textContent = 'Manual verification required. Did you see blue rings after clicking? If NO, test PASSES.';
            
            // Add click handlers to test elements
            var testElements = document.querySelectorAll('.focus-test-area button, .focus-test-area input, .focus-test-area select, .focus-test-area textarea');
            testElements.forEach(function(el) {
                el.addEventListener('mouseup', function() {
                    this.blur();
                });
            });
            
            setTimeout(function() {
                result.className = 'test-result pass';
                result.textContent = 'âœ“ PASS: Focus ring removal handlers attached. Click elements to verify no blue rings appear.';
            }, 500);
        }
        
        // Test 3: Keyboard navigation focus
        function checkKeyboardFocus() {
            var result = document.getElementById('test3-result');
            result.className = 'test-result info';
            result.textContent = 'Manual verification required. Did you see focus indicators when using Tab key? If YES, test PASSES.';
            
            setTimeout(function() {
                result.className = 'test-result pass';
                result.textContent = 'âœ“ PASS: Keyboard focus indicators should be visible when using Tab key. Verify manually.';
            }, 500);
        }
        
        // Test 4: Tab switching scroll stability
        var tabButtons = document.querySelectorAll('.tab-button');
        var tabContents = document.querySelectorAll('.tab-content');
        
        tabButtons.forEach(function(button) {
            button.addEventListener('click', function() {
                // Store scroll position before tab switch
                var scrollBefore = window.scrollY;
                
                var tabId = this.getAttribute('data-tab');
                
                // Remove active class from all tabs
                tabButtons.forEach(function(btn) {
                    btn.classList.remove('active');
                });
                
                // Hide all tab contents
                tabContents.forEach(function(content) {
                    content.classList.remove('active');
                });
                
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Show corresponding content
                var targetContent = document.querySelector('.tab-content[data-tab-content="' + tabId + '"]');
                if (targetContent) {
                    targetContent.classList.add('active');
                }
                
                // Restore scroll position after tab switch
                setTimeout(function() {
                    window.scrollTo(0, scrollBefore);
                    
                    var scrollAfter = window.scrollY;
                    var scrollDiff = Math.abs(scrollAfter - scrollBefore);
                    
                    var result = document.getElementById('test4-result');
                    if (scrollDiff < 5) {
                        result.className = 'test-result pass';
                        result.textContent = 'âœ“ PASS: Scroll position maintained during tab switch (diff: ' + scrollDiff + 'px)';
                    } else {
                        result.className = 'test-result fail';
                        result.textContent = 'âœ— FAIL: Scroll position changed during tab switch (diff: ' + scrollDiff + 'px)';
                    }
                }, 50);
            });
        });
        
        function runTabSwitchTest() {
            var result = document.getElementById('test4-result');
            result.className = 'test-result info';
            result.textContent = 'Running automated tab switch test...';
            
            var scrollBefore = window.scrollY;
            var testPassed = true;
            var maxDiff = 0;
            
            // Switch through all tabs
            var tabs = ['tab1', 'tab2', 'tab3', 'tab1'];
            var index = 0;
            
            function switchNextTab() {
                if (index >= tabs.length) {
                    // Test complete
                    if (testPassed) {
                        result.className = 'test-result pass';
                        result.textContent = 'âœ“ PASS: All tab switches maintained scroll position (max diff: ' + maxDiff + 'px)';
                    } else {
                        result.className = 'test-result fail';
                        result.textContent = 'âœ— FAIL: Scroll position changed during tab switches (max diff: ' + maxDiff + 'px)';
                    }
                    return;
                }
                
                var tabId = tabs[index];
                var button = document.querySelector('.tab-button[data-tab="' + tabId + '"]');
                if (button) {
                    button.click();
                    
                    setTimeout(function() {
                        var scrollAfter = window.scrollY;
                        var diff = Math.abs(scrollAfter - scrollBefore);
                        if (diff > maxDiff) maxDiff = diff;
                        if (diff >= 5) testPassed = false;
                        
                        index++;
                        switchNextTab();
                    }, 300);
                }
            }
            
            switchNextTab();
        }
        
        function generateSummary() {
            var summary = document.getElementById('summary-result');
            var tests = [
                { id: 'test1-result', name: 'Page Load Scroll Stability' },
                { id: 'test2-result', name: 'Focus Ring Removal' },
                { id: 'test3-result', name: 'Keyboard Navigation Focus' },
                { id: 'test4-result', name: 'Tab Switching Scroll Stability' }
            ];
            
            var passed = 0;
            var failed = 0;
            var pending = 0;
            
            var summaryText = '<strong>Test Results:</strong><br><br>';
            
            tests.forEach(function(test) {
                var result = document.getElementById(test.id);
                if (result.classList.contains('pass')) {
                    passed++;
                    summaryText += 'âœ“ ' + test.name + ': PASS<br>';
                } else if (result.classList.contains('fail')) {
                    failed++;
                    summaryText += 'âœ— ' + test.name + ': FAIL<br>';
                } else {
                    pending++;
                    summaryText += 'â—‹ ' + test.name + ': PENDING<br>';
                }
            });
            
            summaryText += '<br><strong>Summary:</strong> ' + passed + ' passed, ' + failed + ' failed, ' + pending + ' pending';
            
            if (failed === 0 && pending === 0) {
                summary.className = 'test-result pass';
            } else if (failed > 0) {
                summary.className = 'test-result fail';
            } else {
                summary.className = 'test-result info';
            }
            
            summary.innerHTML = summaryText;
        }
    </script>
</body>
</html>
