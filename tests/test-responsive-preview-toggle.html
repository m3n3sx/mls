<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Test: Responsive Preview Toggle - Task 29</title>
	<link rel="stylesheet" href="../assets/css/mase-admin.css">
	<style>
		body {
			font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
			padding: 20px;
			background: #f0f0f1;
		}
		
		.test-container {
			max-width: 1200px;
			margin: 0 auto;
			background: #fff;
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 1px 3px rgba(0,0,0,0.1);
		}
		
		h1 {
			margin-top: 0;
			color: #1d2327;
		}
		
		.test-section {
			margin: 30px 0;
			padding: 20px;
			border: 1px solid #ddd;
			border-radius: 4px;
		}
		
		.test-section h2 {
			margin-top: 0;
			font-size: 18px;
			color: #2c3338;
		}
		
		.mase-background-preview-container {
			min-height: 300px;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			border-radius: 8px;
			display: flex;
			align-items: center;
			justify-content: center;
			color: white;
			font-size: 24px;
			font-weight: bold;
			text-shadow: 0 2px 4px rgba(0,0,0,0.3);
		}
		
		.test-results {
			margin-top: 20px;
			padding: 15px;
			background: #f0f6fc;
			border-left: 4px solid #2271b1;
			border-radius: 4px;
		}
		
		.test-results h3 {
			margin-top: 0;
			color: #0c5d8f;
		}
		
		.test-results ul {
			margin: 10px 0;
			padding-left: 20px;
		}
		
		.test-results li {
			margin: 5px 0;
		}
		
		.status-pass {
			color: #00a32a;
			font-weight: bold;
		}
		
		.status-fail {
			color: #d63638;
			font-weight: bold;
		}
		
		/* WordPress Dashicons */
		@font-face {
			font-family: 'dashicons';
			src: url('https://s.w.org/wp-includes/fonts/dashicons.woff2') format('woff2'),
			     url('https://s.w.org/wp-includes/fonts/dashicons.woff') format('woff'),
			     url('https://s.w.org/wp-includes/fonts/dashicons.ttf') format('truetype');
			font-weight: normal;
			font-style: normal;
		}
		
		.dashicons {
			font-family: 'dashicons';
			display: inline-block;
			line-height: 1;
			font-weight: 400;
			font-style: normal;
			speak: never;
			text-decoration: inherit;
			text-transform: none;
			text-rendering: auto;
			-webkit-font-smoothing: antialiased;
			-moz-osx-font-smoothing: grayscale;
			width: 20px;
			height: 20px;
			font-size: 20px;
			vertical-align: top;
		}
		
		.dashicons-desktop:before { content: "\f472"; }
		.dashicons-tablet:before { content: "\f471"; }
		.dashicons-smartphone:before { content: "\f470"; }
		.dashicons-visibility:before { content: "\f177"; }
	</style>
</head>
<body>
	<div class="test-container">
		<h1>Task 29: Responsive Preview Toggle Test</h1>
		<p><strong>Requirement 6.4:</strong> Add device preview buttons, resize preview, apply responsive backgrounds, show breakpoint indicator</p>
		
		<!-- Test Section 1: Device Preview Buttons -->
		<div class="test-section">
			<h2>Test 1: Device Preview Buttons</h2>
			<p>Click each button to switch between device views. The active button should be highlighted.</p>
			
			<div class="mase-responsive-preview-controls">
				<div class="mase-preview-controls-header">
					<h3>Preview Device</h3>
					<p class="description">Switch between device sizes to preview responsive background variations.</p>
				</div>
				
				<div class="mase-device-preview-buttons">
					<button 
						type="button" 
						class="button mase-device-preview-btn active" 
						data-device="desktop"
						aria-pressed="true"
					>
						<span class="dashicons dashicons-desktop"></span>
						<span class="mase-device-label">Desktop</span>
					</button>
					
					<button 
						type="button" 
						class="button mase-device-preview-btn" 
						data-device="tablet"
						aria-pressed="false"
					>
						<span class="dashicons dashicons-tablet"></span>
						<span class="mase-device-label">Tablet</span>
					</button>
					
					<button 
						type="button" 
						class="button mase-device-preview-btn" 
						data-device="mobile"
						aria-pressed="false"
					>
						<span class="dashicons dashicons-smartphone"></span>
						<span class="mase-device-label">Mobile</span>
					</button>
				</div>
				
				<div 
					class="mase-breakpoint-indicator device-desktop" 
					role="status" 
					aria-live="polite"
				>
					<span class="dashicons dashicons-visibility"></span>
					<span class="mase-breakpoint-label">Desktop (≥1024px)</span>
				</div>
			</div>
		</div>
		
		<!-- Test Section 2: Preview Container Resize -->
		<div class="test-section">
			<h2>Test 2: Preview Container Resize</h2>
			<p>The preview container below should resize when you click different device buttons.</p>
			
			<div class="mase-background-preview-container preview-desktop">
				<div class="mase-background-preview-content">
					Preview Area - Watch this resize!
				</div>
			</div>
		</div>
		
		<!-- Test Section 3: Breakpoint Indicator -->
		<div class="test-section">
			<h2>Test 3: Breakpoint Indicator Updates</h2>
			<p>The breakpoint indicator should update its text and color when switching devices.</p>
			
			<div style="display: flex; gap: 20px; flex-wrap: wrap;">
				<div class="mase-breakpoint-indicator device-desktop">
					<span class="dashicons dashicons-visibility"></span>
					<span class="mase-breakpoint-label">Desktop (≥1024px)</span>
				</div>
				
				<div class="mase-breakpoint-indicator device-tablet">
					<span class="dashicons dashicons-visibility"></span>
					<span class="mase-breakpoint-label">Tablet (768-1023px)</span>
				</div>
				
				<div class="mase-breakpoint-indicator device-mobile">
					<span class="dashicons dashicons-visibility"></span>
					<span class="mase-breakpoint-label">Mobile (<768px)</span>
				</div>
			</div>
		</div>
		
		<!-- Test Results -->
		<div class="test-results">
			<h3>Test Results</h3>
			<ul id="test-results-list">
				<li>Loading tests...</li>
			</ul>
		</div>
	</div>
	
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script>
		// Mock MASE object for testing
		var MASE = {
			livePreview: {
				currentDevice: 'desktop',
				deviceDimensions: {
					desktop: { width: '100%', minWidth: 1024 },
					tablet: { width: '768px', minWidth: 768, maxWidth: 1023 },
					mobile: { width: '375px', maxWidth: 767 }
				},
				
				switchDevice: function(device) {
					console.log('Switching to device:', device);
					this.currentDevice = device;
					
					// Update button states
					$('.mase-device-preview-btn').removeClass('active').attr('aria-pressed', 'false');
					$('.mase-device-preview-btn[data-device="' + device + '"]').addClass('active').attr('aria-pressed', 'true');
					
					// Update breakpoint indicator
					this.updateBreakpointIndicator(device);
					
					// Resize preview
					this.resizePreview(device);
					
					// Log test result
					logTestResult('Device switched to ' + device, true);
				},
				
				updateBreakpointIndicator: function(device) {
					var $indicator = $('.mase-breakpoint-indicator');
					$indicator.removeClass('device-desktop device-tablet device-mobile').addClass('device-' + device);
					
					var labels = {
						desktop: 'Desktop (≥1024px)',
						tablet: 'Tablet (768-1023px)',
						mobile: 'Mobile (<768px)'
					};
					
					$indicator.find('.mase-breakpoint-label').text(labels[device]);
					logTestResult('Breakpoint indicator updated to ' + device, true);
				},
				
				resizePreview: function(device) {
					var dimensions = this.deviceDimensions[device];
					var $previewContainer = $('.mase-background-preview-container');
					
					$previewContainer.css({
						'width': dimensions.width,
						'max-width': dimensions.maxWidth ? dimensions.maxWidth + 'px' : 'none',
						'min-width': dimensions.minWidth ? dimensions.minWidth + 'px' : 'auto',
						'margin': device === 'desktop' ? '0' : '0 auto',
						'transition': 'all 0.3s ease'
					});
					
					$previewContainer
						.removeClass('preview-desktop preview-tablet preview-mobile')
						.addClass('preview-' + device);
					
					logTestResult('Preview resized to ' + device + ' (' + dimensions.width + ')', true);
				}
			}
		};
		
		// Test results tracking
		var testResults = [];
		
		function logTestResult(message, passed) {
			testResults.push({ message: message, passed: passed });
			updateTestResults();
		}
		
		function updateTestResults() {
			var $list = $('#test-results-list');
			$list.empty();
			
			if (testResults.length === 0) {
				$list.append('<li>No tests run yet. Click the device buttons above.</li>');
				return;
			}
			
			testResults.forEach(function(result) {
				var statusClass = result.passed ? 'status-pass' : 'status-fail';
				var statusText = result.passed ? '✓ PASS' : '✗ FAIL';
				$list.append('<li><span class="' + statusClass + '">' + statusText + '</span>: ' + result.message + '</li>');
			});
		}
		
		// Initialize tests
		$(document).ready(function() {
			console.log('Test page loaded');
			
			// Bind device preview buttons
			$(document).on('click', '.mase-device-preview-btn', function(e) {
				e.preventDefault();
				var device = $(this).data('device');
				if (device) {
					MASE.livePreview.switchDevice(device);
				}
			});
			
			// Run initial tests
			logTestResult('Page loaded successfully', true);
			logTestResult('Device preview buttons rendered', $('.mase-device-preview-btn').length === 3);
			logTestResult('Breakpoint indicator rendered', $('.mase-breakpoint-indicator').length > 0);
			logTestResult('Preview container rendered', $('.mase-background-preview-container').length > 0);
			
			// Test button click
			setTimeout(function() {
				console.log('Running automated button click test...');
				$('.mase-device-preview-btn[data-device="tablet"]').click();
				
				setTimeout(function() {
					$('.mase-device-preview-btn[data-device="mobile"]').click();
					
					setTimeout(function() {
						$('.mase-device-preview-btn[data-device="desktop"]').click();
						logTestResult('All device buttons tested successfully', true);
					}, 500);
				}, 500);
			}, 1000);
		});
	</script>
</body>
</html>
