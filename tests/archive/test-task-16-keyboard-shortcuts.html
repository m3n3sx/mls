<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task 16: Keyboard Shortcuts Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f0f0f1;
        }
        
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        h1 {
            color: #1d2327;
            border-bottom: 2px solid #2271b1;
            padding-bottom: 10px;
        }
        
        h2 {
            color: #2271b1;
            margin-top: 30px;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #f6f7f7;
            border-radius: 4px;
        }
        
        .shortcut-list {
            list-style: none;
            padding: 0;
        }
        
        .shortcut-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 4px;
            border-left: 4px solid #2271b1;
        }
        
        .shortcut-key {
            font-family: 'Courier New', monospace;
            background: #1d2327;
            color: white;
            padding: 4px 8px;
            border-radius: 3px;
            margin-right: 15px;
            font-weight: bold;
            min-width: 150px;
        }
        
        .shortcut-description {
            flex: 1;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ddd;
            margin-left: 10px;
        }
        
        .status-indicator.active {
            background: #00a32a;
        }
        
        .palette-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .palette-card {
            padding: 15px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .palette-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .palette-card.active {
            border-color: #2271b1;
            background: #f0f6fc;
        }
        
        .palette-colors {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .color-swatch {
            width: 30px;
            height: 30px;
            border-radius: 3px;
            border: 1px solid #ddd;
        }
        
        .settings-panel {
            background: white;
            padding: 20px;
            border-radius: 4px;
            margin: 20px 0;
        }
        
        .setting-row {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f1;
        }
        
        .setting-row:last-child {
            border-bottom: none;
        }
        
        .setting-label {
            flex: 1;
            font-weight: 500;
        }
        
        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .3s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .3s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #2271b1;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }
        
        .notice {
            padding: 12px 20px;
            margin: 15px 0;
            border-radius: 4px;
            border-left: 4px solid;
        }
        
        .notice.info {
            background: #f0f6fc;
            border-color: #2271b1;
            color: #1d2327;
        }
        
        .notice.success {
            background: #edfaef;
            border-color: #00a32a;
            color: #1d2327;
        }
        
        .notice.warning {
            background: #fcf9e8;
            border-color: #dba617;
            color: #1d2327;
        }
        
        .test-log {
            background: #1d2327;
            color: #00ff00;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .test-log-entry {
            margin: 5px 0;
        }
        
        .test-log-entry.error {
            color: #ff6b6b;
        }
        
        .test-log-entry.success {
            color: #51cf66;
        }
        
        .button {
            background: #2271b1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        
        .button:hover {
            background: #135e96;
        }
        
        .button.secondary {
            background: #ddd;
            color: #1d2327;
        }
        
        .button.secondary:hover {
            background: #ccc;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Task 16: Keyboard Shortcuts Implementation Test</h1>
        
        <div class="notice info">
            <strong>Test Instructions:</strong> Use the keyboard shortcuts listed below to test the functionality. 
            Make sure the corresponding settings are enabled in the Settings Panel.
        </div>
        
        <h2>Keyboard Shortcuts</h2>
        <div class="test-section">
            <ul class="shortcut-list">
                <li class="shortcut-item">
                    <span class="shortcut-key">Ctrl+Shift+1-9</span>
                    <span class="shortcut-description">Switch to palette 1-9</span>
                    <span class="status-indicator" id="status-palette-1-9"></span>
                </li>
                <li class="shortcut-item">
                    <span class="shortcut-key">Ctrl+Shift+0</span>
                    <span class="shortcut-description">Switch to palette 10</span>
                    <span class="status-indicator" id="status-palette-10"></span>
                </li>
                <li class="shortcut-item">
                    <span class="shortcut-key">Ctrl+Shift+T</span>
                    <span class="shortcut-description">Toggle between light and dark themes</span>
                    <span class="status-indicator" id="status-theme-toggle"></span>
                </li>
                <li class="shortcut-item">
                    <span class="shortcut-key">Ctrl+Shift+F</span>
                    <span class="shortcut-description">Toggle focus mode (hide distractions)</span>
                    <span class="status-indicator" id="status-focus-mode"></span>
                </li>
                <li class="shortcut-item">
                    <span class="shortcut-key">Ctrl+Shift+P</span>
                    <span class="shortcut-description">Toggle performance mode (disable effects)</span>
                    <span class="status-indicator" id="status-performance-mode"></span>
                </li>
            </ul>
        </div>
        
        <h2>Settings Panel</h2>
        <div class="settings-panel">
            <div class="setting-row">
                <span class="setting-label">Enable Keyboard Shortcuts</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="keyboard-shortcuts-enabled" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-row">
                <span class="setting-label">Enable Palette Switching</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="keyboard-shortcuts-palette-switch" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-row">
                <span class="setting-label">Enable Theme Toggle</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="keyboard-shortcuts-theme-toggle" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-row">
                <span class="setting-label">Enable Focus Mode Toggle</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="keyboard-shortcuts-focus-mode" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-row">
                <span class="setting-label">Enable Performance Mode Toggle</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="keyboard-shortcuts-performance-mode" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>
        
        <h2>Test Palettes</h2>
        <div class="palette-grid">
            <div class="palette-card mase-palette-card active" data-palette-id="professional-blue">
                <strong>1. Professional Blue</strong>
                <div class="palette-colors">
                    <div class="color-swatch" style="background: #4A90E2;"></div>
                    <div class="color-swatch" style="background: #50C9C3;"></div>
                    <div class="color-swatch" style="background: #7B68EE;"></div>
                </div>
            </div>
            <div class="palette-card mase-palette-card" data-palette-id="energetic-green">
                <strong>2. Energetic Green</strong>
                <div class="palette-colors">
                    <div class="color-swatch" style="background: #2ECC71;"></div>
                    <div class="color-swatch" style="background: #27AE60;"></div>
                    <div class="color-swatch" style="background: #F39C12;"></div>
                </div>
            </div>
            <div class="palette-card mase-palette-card" data-palette-id="sunset">
                <strong>3. Sunset</strong>
                <div class="palette-colors">
                    <div class="color-swatch" style="background: #E74C3C;"></div>
                    <div class="color-swatch" style="background: #F39C12;"></div>
                    <div class="color-swatch" style="background: #E67E22;"></div>
                </div>
            </div>
            <div class="palette-card mase-palette-card" data-palette-id="midnight-purple">
                <strong>4. Midnight Purple</strong>
                <div class="palette-colors">
                    <div class="color-swatch" style="background: #8E44AD;"></div>
                    <div class="color-swatch" style="background: #9B59B6;"></div>
                    <div class="color-swatch" style="background: #3498DB;"></div>
                </div>
            </div>
            <div class="palette-card mase-palette-card" data-palette-id="ocean-breeze">
                <strong>5. Ocean Breeze</strong>
                <div class="palette-colors">
                    <div class="color-swatch" style="background: #3498DB;"></div>
                    <div class="color-swatch" style="background: #2980B9;"></div>
                    <div class="color-swatch" style="background: #1ABC9C;"></div>
                </div>
            </div>
            <div class="palette-card mase-palette-card" data-palette-id="warm-autumn">
                <strong>6. Warm Autumn</strong>
                <div class="palette-colors">
                    <div class="color-swatch" style="background: #D35400;"></div>
                    <div class="color-swatch" style="background: #E67E22;"></div>
                    <div class="color-swatch" style="background: #F39C12;"></div>
                </div>
            </div>
            <div class="palette-card mase-palette-card" data-palette-id="cool-winter">
                <strong>7. Cool Winter</strong>
                <div class="palette-colors">
                    <div class="color-swatch" style="background: #34495E;"></div>
                    <div class="color-swatch" style="background: #2C3E50;"></div>
                    <div class="color-swatch" style="background: #7F8C8D;"></div>
                </div>
            </div>
            <div class="palette-card mase-palette-card" data-palette-id="vibrant-coral">
                <strong>8. Vibrant Coral</strong>
                <div class="palette-colors">
                    <div class="color-swatch" style="background: #FF6B6B;"></div>
                    <div class="color-swatch" style="background: #EE5A6F;"></div>
                    <div class="color-swatch" style="background: #C44569;"></div>
                </div>
            </div>
            <div class="palette-card mase-palette-card" data-palette-id="forest-green">
                <strong>9. Forest Green</strong>
                <div class="palette-colors">
                    <div class="color-swatch" style="background: #27AE60;"></div>
                    <div class="color-swatch" style="background: #229954;"></div>
                    <div class="color-swatch" style="background: #1E8449;"></div>
                </div>
            </div>
            <div class="palette-card mase-palette-card" data-palette-id="dark-elegance">
                <strong>10. Dark Elegance</strong>
                <div class="palette-colors">
                    <div class="color-swatch" style="background: #2C3E50;"></div>
                    <div class="color-swatch" style="background: #34495E;"></div>
                    <div class="color-swatch" style="background: #7F8C8D;"></div>
                </div>
            </div>
        </div>
        
        <h2>Mode Toggles</h2>
        <div class="settings-panel">
            <div class="setting-row">
                <span class="setting-label">Focus Mode</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="effects-focus-mode">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            <div class="setting-row">
                <span class="setting-label">Performance Mode</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="effects-performance-mode">
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>
        
        <h2>Test Actions</h2>
        <div class="test-section">
            <button class="button" onclick="runAllTests()">Run All Tests</button>
            <button class="button secondary" onclick="clearLog()">Clear Log</button>
        </div>
        
        <div id="mase-notices"></div>
        
        <h2>Test Log</h2>
        <div class="test-log" id="test-log">
            <div class="test-log-entry">Ready to test keyboard shortcuts...</div>
        </div>
    </div>
    
    <!-- Hidden nonce field for MASE -->
    <input type="hidden" id="mase_nonce" value="test-nonce-12345">
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../assets/js/mase-admin.js"></script>
    <script>
        // Test log utility
        function log(message, type = 'info') {
            const logDiv = document.getElementById('test-log');
            const entry = document.createElement('div');
            entry.className = 'test-log-entry ' + type;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function clearLog() {
            document.getElementById('test-log').innerHTML = '<div class="test-log-entry">Log cleared...</div>';
        }
        
        // Override MASE methods for testing
        $(document).ready(function() {
            // Override paletteManager.apply to simulate palette switching
            const originalApply = MASE.paletteManager.apply;
            MASE.paletteManager.apply = function(paletteId) {
                log('Applying palette: ' + paletteId, 'success');
                
                // Update active state
                $('.mase-palette-card').removeClass('active');
                $('.mase-palette-card[data-palette-id="' + paletteId + '"]').addClass('active');
                
                // Show notice
                MASE.showNotice('success', 'Palette "' + paletteId + '" applied successfully!');
                
                // Update status indicator
                $('#status-palette-1-9, #status-palette-10').addClass('active');
                setTimeout(function() {
                    $('#status-palette-1-9, #status-palette-10').removeClass('active');
                }, 2000);
            };
            
            // Monitor keyboard events
            $(document).on('keydown', function(e) {
                if (e.ctrlKey && e.shiftKey) {
                    log('Keyboard shortcut detected: Ctrl+Shift+' + e.key);
                }
            });
            
            // Monitor toggle changes
            $('#effects-focus-mode').on('change', function() {
                const status = $(this).is(':checked') ? 'enabled' : 'disabled';
                log('Focus mode ' + status, 'success');
                $('#status-focus-mode').addClass('active');
                setTimeout(function() {
                    $('#status-focus-mode').removeClass('active');
                }, 2000);
            });
            
            $('#effects-performance-mode').on('change', function() {
                const status = $(this).is(':checked') ? 'enabled' : 'disabled';
                log('Performance mode ' + status, 'success');
                $('#status-performance-mode').addClass('active');
                setTimeout(function() {
                    $('#status-performance-mode').removeClass('active');
                }, 2000);
            });
            
            log('Test environment initialized', 'success');
        });
        
        // Automated test suite
        function runAllTests() {
            log('=== Starting Automated Tests ===', 'info');
            
            // Test 1: Check if keyboard shortcuts module exists
            if (typeof MASE.keyboardShortcuts !== 'undefined') {
                log('✓ Keyboard shortcuts module exists', 'success');
            } else {
                log('✗ Keyboard shortcuts module not found', 'error');
                return;
            }
            
            // Test 2: Check if bind method exists
            if (typeof MASE.keyboardShortcuts.bind === 'function') {
                log('✓ bind() method exists', 'success');
            } else {
                log('✗ bind() method not found', 'error');
            }
            
            // Test 3: Check if handle method exists
            if (typeof MASE.keyboardShortcuts.handle === 'function') {
                log('✓ handle() method exists', 'success');
            } else {
                log('✗ handle() method not found', 'error');
            }
            
            // Test 4: Check if switchPalette method exists
            if (typeof MASE.keyboardShortcuts.switchPalette === 'function') {
                log('✓ switchPalette() method exists', 'success');
            } else {
                log('✗ switchPalette() method not found', 'error');
            }
            
            // Test 5: Check if toggleTheme method exists
            if (typeof MASE.keyboardShortcuts.toggleTheme === 'function') {
                log('✓ toggleTheme() method exists', 'success');
            } else {
                log('✗ toggleTheme() method not found', 'error');
            }
            
            // Test 6: Check if toggleFocusMode method exists
            if (typeof MASE.keyboardShortcuts.toggleFocusMode === 'function') {
                log('✓ toggleFocusMode() method exists', 'success');
            } else {
                log('✗ toggleFocusMode() method not found', 'error');
            }
            
            // Test 7: Check if togglePerformanceMode method exists
            if (typeof MASE.keyboardShortcuts.togglePerformanceMode === 'function') {
                log('✓ togglePerformanceMode() method exists', 'success');
            } else {
                log('✗ togglePerformanceMode() method not found', 'error');
            }
            
            // Test 8: Simulate palette switch
            log('Testing palette switch...', 'info');
            MASE.keyboardShortcuts.switchPalette(1);
            
            // Test 9: Simulate focus mode toggle
            setTimeout(function() {
                log('Testing focus mode toggle...', 'info');
                MASE.keyboardShortcuts.toggleFocusMode();
            }, 500);
            
            // Test 10: Simulate performance mode toggle
            setTimeout(function() {
                log('Testing performance mode toggle...', 'info');
                MASE.keyboardShortcuts.togglePerformanceMode();
            }, 1000);
            
            setTimeout(function() {
                log('=== All Tests Completed ===', 'success');
            }, 1500);
        }
    </script>
</body>
</html>
