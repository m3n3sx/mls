<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Menu Google Fonts Integration Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 20px;
            background: #f0f0f1;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1d2327;
            border-bottom: 2px solid #2271b1;
            padding-bottom: 10px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .test-section h2 {
            color: #2271b1;
            margin-top: 0;
        }
        .control-group {
            margin: 15px 0;
        }
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
        }
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #8c8f94;
            border-radius: 4px;
            font-size: 14px;
        }
        .preview-area {
            margin-top: 20px;
            padding: 20px;
            background: #f6f7f7;
            border-radius: 4px;
        }
        .menu-preview {
            background: #23282d;
            color: #ffffff;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .submenu-preview {
            background: #32373c;
            color: #ffffff;
            padding: 10px 15px;
            border-radius: 4px;
            margin-left: 20px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.success {
            background: #d7f0d7;
            color: #1e4620;
            border: 1px solid #00a32a;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #d32f2f;
        }
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #0073aa;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Admin Menu Google Fonts Integration Test</h1>
        <p>This test verifies that Google Fonts can be selected and loaded for the admin menu and submenu.</p>

        <!-- Test 1: Menu Font Family Selection -->
        <div class="test-section">
            <h2>Test 1: Menu Font Family Selection</h2>
            <div class="control-group">
                <label for="admin-menu-font-family">Menu Font Family:</label>
                <select id="admin-menu-font-family">
                    <optgroup label="System Fonts">
                        <option value="system">System Default</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="Helvetica, sans-serif">Helvetica</option>
                        <option value="Georgia, serif">Georgia</option>
                    </optgroup>
                    <optgroup label="Google Fonts">
                        <option value="google:Roboto">Roboto</option>
                        <option value="google:Open Sans">Open Sans</option>
                        <option value="google:Lato">Lato</option>
                        <option value="google:Montserrat">Montserrat</option>
                        <option value="google:Poppins">Poppins</option>
                        <option value="google:Inter">Inter</option>
                        <option value="google:Raleway">Raleway</option>
                        <option value="google:Source Sans Pro">Source Sans Pro</option>
                        <option value="google:Nunito">Nunito</option>
                        <option value="google:Ubuntu">Ubuntu</option>
                    </optgroup>
                </select>
            </div>
            <div class="preview-area">
                <div class="menu-preview" id="menu-preview">
                    <div>Dashboard</div>
                    <div>Posts</div>
                    <div>Media</div>
                    <div>Pages</div>
                </div>
            </div>
            <div id="menu-status" class="status info">Select a font to test</div>
        </div>

        <!-- Test 2: Submenu Font Family Selection -->
        <div class="test-section">
            <h2>Test 2: Submenu Font Family Selection</h2>
            <div class="control-group">
                <label for="admin-menu-submenu-font-family">Submenu Font Family:</label>
                <select id="admin-menu-submenu-font-family">
                    <optgroup label="System Fonts">
                        <option value="system">System Default</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="Helvetica, sans-serif">Helvetica</option>
                        <option value="Georgia, serif">Georgia</option>
                    </optgroup>
                    <optgroup label="Google Fonts">
                        <option value="google:Roboto">Roboto</option>
                        <option value="google:Open Sans">Open Sans</option>
                        <option value="google:Lato">Lato</option>
                        <option value="google:Montserrat">Montserrat</option>
                        <option value="google:Poppins">Poppins</option>
                        <option value="google:Inter">Inter</option>
                        <option value="google:Raleway">Raleway</option>
                        <option value="google:Source Sans Pro">Source Sans Pro</option>
                        <option value="google:Nunito">Nunito</option>
                        <option value="google:Ubuntu">Ubuntu</option>
                    </optgroup>
                </select>
            </div>
            <div class="preview-area">
                <div class="submenu-preview" id="submenu-preview">
                    <div>All Posts</div>
                    <div>Add New</div>
                    <div>Categories</div>
                    <div>Tags</div>
                </div>
            </div>
            <div id="submenu-status" class="status info">Select a font to test</div>
        </div>

        <!-- Test 3: Google Font Loading -->
        <div class="test-section">
            <h2>Test 3: Google Font Loading Verification</h2>
            <div id="font-loading-status" class="status info">
                <strong>Loaded Fonts:</strong>
                <ul id="loaded-fonts-list"></ul>
            </div>
        </div>
    </div>

    <script>
        // Mock MASE object with adminBarPreview.loadGoogleFont method
        const MASE = {
            adminBarPreview: {
                loadGoogleFont: function(fontName, callback) {
                    if (!fontName) return;
                    
                    // Check if already loaded
                    const linkId = 'mase-google-font-' + fontName.replace(/\s+/g, '-').toLowerCase();
                    if (document.getElementById(linkId)) {
                        console.log('Font already loaded:', fontName);
                        if (callback) callback();
                        return;
                    }
                    
                    // Create link element
                    const link = document.createElement('link');
                    link.id = linkId;
                    link.rel = 'stylesheet';
                    link.href = 'https://fonts.googleapis.com/css2?family=' + 
                                fontName.replace(/\s+/g, '+') + ':wght@300;400;500;600;700&display=swap';
                    
                    // Handle loading errors
                    link.onerror = function() {
                        console.error('Failed to load Google Font:', fontName);
                        updateStatus('error', 'Failed to load font "' + fontName + '"');
                        if (callback) callback();
                    };
                    
                    // Execute callback after successful load
                    link.onload = function() {
                        console.log('Successfully loaded Google Font:', fontName);
                        updateStatus('success', 'Successfully loaded font "' + fontName + '"');
                        updateLoadedFontsList();
                        if (callback) callback();
                    };
                    
                    // Add to head
                    document.head.appendChild(link);
                }
            }
        };

        // Menu font family change handler
        document.getElementById('admin-menu-font-family').addEventListener('change', function(e) {
            const fontFamily = e.target.value;
            const preview = document.getElementById('menu-preview');
            const status = document.getElementById('menu-status');
            
            if (fontFamily.startsWith('google:')) {
                const fontName = fontFamily.replace('google:', '');
                status.className = 'status info';
                status.textContent = 'Loading font "' + fontName + '"...';
                
                MASE.adminBarPreview.loadGoogleFont(fontName, function() {
                    preview.style.fontFamily = '"' + fontName + '", sans-serif';
                    status.className = 'status success';
                    status.textContent = 'Font "' + fontName + '" applied successfully';
                });
            } else if (fontFamily === 'system') {
                preview.style.fontFamily = 'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                status.className = 'status success';
                status.textContent = 'System font applied';
            } else {
                preview.style.fontFamily = fontFamily;
                status.className = 'status success';
                status.textContent = 'Font applied: ' + fontFamily;
            }
        });

        // Submenu font family change handler
        document.getElementById('admin-menu-submenu-font-family').addEventListener('change', function(e) {
            const fontFamily = e.target.value;
            const preview = document.getElementById('submenu-preview');
            const status = document.getElementById('submenu-status');
            
            if (fontFamily.startsWith('google:')) {
                const fontName = fontFamily.replace('google:', '');
                status.className = 'status info';
                status.textContent = 'Loading font "' + fontName + '"...';
                
                MASE.adminBarPreview.loadGoogleFont(fontName, function() {
                    preview.style.fontFamily = '"' + fontName + '", sans-serif';
                    status.className = 'status success';
                    status.textContent = 'Font "' + fontName + '" applied successfully';
                });
            } else if (fontFamily === 'system') {
                preview.style.fontFamily = 'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                status.className = 'status success';
                status.textContent = 'System font applied';
            } else {
                preview.style.fontFamily = fontFamily;
                status.className = 'status success';
                status.textContent = 'Font applied: ' + fontFamily;
            }
        });

        // Update status helper
        function updateStatus(type, message) {
            // This is handled in the loadGoogleFont callbacks
        }

        // Update loaded fonts list
        function updateLoadedFontsList() {
            const list = document.getElementById('loaded-fonts-list');
            list.innerHTML = '';
            
            const links = document.querySelectorAll('link[id^="mase-google-font-"]');
            if (links.length === 0) {
                list.innerHTML = '<li>No Google Fonts loaded yet</li>';
            } else {
                links.forEach(link => {
                    const fontName = link.id.replace('mase-google-font-', '').replace(/-/g, ' ');
                    const li = document.createElement('li');
                    li.textContent = fontName.split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
                    list.appendChild(li);
                });
            }
        }

        // Initialize
        updateLoadedFontsList();
    </script>
</body>
</html>
