/**
 * MASE Accessibility Styles
 * Material Design 3 Transformation
 * 
 * Implements WCAG 2.1 AA accessibility requirements:
 * - Focus indicators
 * - Color contrast
 * - Keyboard navigation
 * - Reduced motion support
 */

/* ============================================
   FOCUS INDICATORS
   ============================================ */

/**
 * Global focus indicator for all interactive elements
 * Requirements: 21.2, 21.4
 * - 3px outline width
 * - Primary color
 * - 2px offset for visibility
 */
*:focus-visible {
    outline: 3px solid var(--md-primary, #6750a4);
    outline-offset: 2px;
    border-radius: var(--md-corner-xs, 4px);
}

/* Remove default browser focus outline */
*:focus {
    outline: none;
}

/* Ensure focus-visible works in all browsers */
*:focus:not(:focus-visible) {
    outline: none;
}

/* ============================================
   COMPONENT-SPECIFIC FOCUS INDICATORS
   ============================================ */

/* Buttons - High contrast focus */
.mase-button-filled:focus-visible,
.mase-button-outlined:focus-visible,
.mase-button-text:focus-visible,
button:focus-visible,
.button:focus-visible {
    outline: 3px solid var(--md-primary, #6750a4);
    outline-offset: 2px;
}

/* Filled buttons need contrasting outline */
.mase-button-filled:focus-visible {
    outline-color: var(--md-on-surface, #1c1b1f);
}

/* Navigation tabs */
.mase-nav-tab:focus-visible {
    outline: 3px solid var(--md-primary, #6750a4);
    outline-offset: 2px;
    z-index: 1;
}

/* Template cards */
.mase-template-card:focus-visible {
    outline: 3px solid var(--md-primary, #6750a4);
    outline-offset: 2px;
}

/* Form controls */
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
    outline: 3px solid var(--md-primary, #6750a4);
    outline-offset: 2px;
}

/* Toggle switches */
.mase-toggle:focus-visible {
    outline: 3px solid var(--md-primary, #6750a4);
    outline-offset: 2px;
}

/* Color pickers */
.mase-color-picker:focus-visible {
    outline: 3px solid var(--md-primary, #6750a4);
    outline-offset: 2px;
}

/* FAB (Floating Action Button) */
.mase-fab:focus-visible {
    outline: 3px solid var(--md-on-surface, #1c1b1f);
    outline-offset: 2px;
}

/* Links */
a:focus-visible {
    outline: 3px solid var(--md-primary, #6750a4);
    outline-offset: 2px;
    border-radius: var(--md-corner-xs, 4px);
}

/* WordPress admin elements */
.wp-core-ui .button:focus-visible,
.wp-core-ui .button-primary:focus-visible,
.wp-core-ui .button-secondary:focus-visible {
    outline: 3px solid var(--md-primary, #6750a4);
    outline-offset: 2px;
}

/* ============================================
   DARK MODE FOCUS INDICATORS
   ============================================ */

/**
 * Adjust focus indicators for dark mode
 * Ensure visibility on dark backgrounds
 */
:root[data-theme="dark"] *:focus-visible {
    outline-color: var(--md-primary, #cfbcff);
}

:root[data-theme="dark"] .mase-button-filled:focus-visible,
:root[data-theme="dark"] .mase-fab:focus-visible {
    outline-color: var(--md-on-surface, #e6e1e5);
}

/* ============================================
   KEYBOARD NAVIGATION ENHANCEMENTS
   ============================================ */

/**
 * Skip links for keyboard navigation
 * Requirements: 21.3
 */
.mase-skip-link {
    position: absolute;
    top: -40px;
    left: 0;
    background: var(--md-primary, #6750a4);
    color: var(--md-on-primary, #ffffff);
    padding: var(--md-space-s, 8px) var(--md-space-l, 16px);
    text-decoration: none;
    border-radius: 0 0 var(--md-corner-s, 8px) 0;
    z-index: 10000;
    transition: top var(--md-duration-short-4, 200ms) var(--md-easing-standard);
}

.mase-skip-link:focus {
    top: 0;
    outline: 3px solid var(--md-on-surface, #1c1b1f);
    outline-offset: 2px;
}

/**
 * Ensure all interactive elements are keyboard accessible
 * Add tabindex where needed
 */
.mase-template-card {
    cursor: pointer;
}

.mase-template-card:not([tabindex]) {
    tabindex: 0;
}

/* Visual feedback for keyboard interaction */
.mase-template-card:focus-visible {
    transform: translateY(-2px);
    box-shadow: var(--md-elevation-2);
}

/* ============================================
   REDUCED MOTION SUPPORT
   ============================================ */

/**
 * Respect user's motion preferences
 * Requirements: 21.4, 21.5
 */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
    
    /* Maintain focus indicators even with reduced motion */
    *:focus-visible {
        outline: 3px solid var(--md-primary, #6750a4);
        outline-offset: 2px;
    }
    
    /* Disable decorative animations */
    .mase-loading-shimmer,
    .mase-template-minibar,
    .mase-template-menuitem,
    .mase-admin-header::before,
    .mase-color-picker {
        animation: none !important;
    }
    
    /* Keep functional transitions instant but present */
    .mase-nav-tab,
    .mase-button-filled,
    .mase-button-outlined,
    .mase-toggle {
        transition-duration: 0.01ms !important;
    }
    
    /* Remove transform animations */
    .mase-template-card:hover,
    .mase-button-filled:hover,
    .mase-fab:hover {
        transform: none !important;
    }
}

/* ============================================
   HIGH CONTRAST MODE SUPPORT
   ============================================ */

/**
 * Enhanced visibility in high contrast mode
 */
@media (prefers-contrast: high) {
    *:focus-visible {
        outline-width: 4px;
        outline-offset: 3px;
    }
    
    /* Increase border visibility */
    .mase-button-outlined,
    .mase-nav-tab,
    input,
    textarea,
    select {
        border-width: 2px;
    }
}

/* ============================================
   SCREEN READER SUPPORT
   ============================================ */

/**
 * Screen reader only text
 * Visually hidden but accessible to screen readers
 */
.mase-sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
}

/* Allow screen reader text to be focusable */
.mase-sr-only:focus {
    position: static;
    width: auto;
    height: auto;
    padding: inherit;
    margin: inherit;
    overflow: visible;
    clip: auto;
    white-space: normal;
}

/* ============================================
   TOUCH TARGET SIZES
   ============================================ */

/**
 * Ensure minimum touch target size of 44x44px
 * WCAG 2.1 Level AAA (2.5.5)
 */
@media (pointer: coarse) {
    button,
    .button,
    .mase-button-filled,
    .mase-button-outlined,
    .mase-button-text,
    .mase-nav-tab,
    .mase-toggle,
    a {
        min-height: 44px;
        min-width: 44px;
    }
    
    /* Increase padding for better touch targets */
    .mase-button-filled,
    .mase-button-outlined,
    .mase-button-text {
        padding: var(--md-space-m, 12px) var(--md-space-xl, 24px);
    }
}

/* ============================================
   FOCUS TRAP FOR MODALS
   ============================================ */

/**
 * Ensure focus stays within modal dialogs
 */
.mase-modal[aria-hidden="false"] {
    /* Focus trap will be handled by JavaScript */
}

/* Prevent focus on background content when modal is open */
body.mase-modal-open > *:not(.mase-modal) {
    pointer-events: none;
}

body.mase-modal-open .mase-modal {
    pointer-events: auto;
}

/* ============================================
   ARIA LIVE REGIONS
   ============================================ */

/**
 * Announce dynamic content changes to screen readers
 */
.mase-live-region {
    position: absolute;
    left: -10000px;
    width: 1px;
    height: 1px;
    overflow: hidden;
}

/* ============================================
   COLOR CONTRAST HELPERS
   ============================================ */

/**
 * Ensure text meets WCAG 2.1 AA contrast requirements
 * Minimum 4.5:1 for normal text, 3:1 for large text
 */

/* High contrast text on colored backgrounds */
.mase-high-contrast-text {
    color: var(--md-on-surface, #1c1b1f);
    text-shadow: 0 0 2px rgba(255, 255, 255, 0.5);
}

:root[data-theme="dark"] .mase-high-contrast-text {
    color: var(--md-on-surface, #e6e1e5);
    text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
}

/* ============================================
   FOCUS MANAGEMENT
   ============================================ */

/**
 * Prevent focus on disabled elements
 */
[disabled],
[aria-disabled="true"] {
    pointer-events: none;
    opacity: 0.38;
}

[disabled]:focus,
[aria-disabled="true"]:focus {
    outline: none;
}

/**
 * Ensure focus is visible on all interactive elements
 */
[role="button"]:focus-visible,
[role="tab"]:focus-visible,
[role="link"]:focus-visible {
    outline: 3px solid var(--md-primary, #6750a4);
    outline-offset: 2px;
}
