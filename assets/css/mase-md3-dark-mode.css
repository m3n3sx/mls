/**
 * Material Design 3 Dark Mode Optimizations
 * 
 * Optimizes glow effects, gradients, and glassmorphism for dark backgrounds
 * Requirements: 20.3, 20.4
 * 
 * @package ModernAdminStyler
 * @since 1.3.0
 */

/* ============================================
   DARK MODE GRADIENT ADJUSTMENTS
   Requirement: 20.3, 20.4
   ============================================ */

/* Reduce gradient brightness for dark backgrounds */
:root[data-theme="dark"] .mase-md3-header,
.mase-dark-mode .mase-md3-header {
	background: linear-gradient(
		135deg,
		color-mix(in srgb, var(--md-primary) 85%, black) 0%,
		color-mix(in srgb, var(--md-tertiary) 85%, black) 100%
	);
}

/* Adjust template card header gradients for dark mode */
:root[data-theme="dark"] .mase-template-header,
.mase-dark-mode .mase-template-header {
	background: linear-gradient(
		135deg,
		color-mix(in srgb, var(--template-primary, var(--md-primary)) 80%, black),
		color-mix(in srgb, var(--template-secondary, var(--md-tertiary)) 80%, black)
	);
}

/* ============================================
   GLOW EFFECTS OPTIMIZATION
   Requirement: 20.3
   ============================================ */

/* Reduce glow intensity for dark backgrounds */
:root[data-theme="dark"] .mase-header-orb,
.mase-dark-mode .mase-header-orb {
	background: radial-gradient(
		circle,
		rgba(255, 255, 255, 0.08) 0%,
		rgba(255, 255, 255, 0.02) 50%,
		transparent 70%
	);
}

/* Adjust button glow effects */
:root[data-theme="dark"] .mase-button-filled:hover,
.mase-dark-mode .mase-button-filled:hover {
	box-shadow: 
		var(--md-elevation-2),
		0 0 20px rgba(var(--md-primary-rgb), 0.3);
}

/* Adjust FAB glow */
:root[data-theme="dark"] .mase-fab:hover,
.mase-dark-mode .mase-fab:hover {
	box-shadow: 
		var(--md-elevation-4),
		0 0 24px rgba(var(--md-primary-rgb), 0.4);
}

/* ============================================
   GLASSMORPHISM ADJUSTMENTS
   Requirement: 20.4
   ============================================ */

/* Adjust glassmorphism backdrop blur for dark surfaces */
:root[data-theme="dark"] .mase-glass-effect,
.mase-dark-mode .mase-glass-effect {
	background: rgba(var(--md-surface-rgb), 0.7);
	backdrop-filter: blur(20px) saturate(180%);
	-webkit-backdrop-filter: blur(20px) saturate(180%);
	border: 1px solid rgba(255, 255, 255, 0.1);
}

/* Modal and dialog glassmorphism */
:root[data-theme="dark"] .mase-modal-content,
.mase-dark-mode .mase-modal-content {
	background: rgba(var(--md-surface-rgb), 0.85);
	backdrop-filter: blur(24px) saturate(180%);
	-webkit-backdrop-filter: blur(24px) saturate(180%);
	border: 1px solid rgba(255, 255, 255, 0.12);
}

/* Snackbar glassmorphism */
:root[data-theme="dark"] .mase-snackbar,
.mase-dark-mode .mase-snackbar {
	background: rgba(var(--md-inverse-surface-rgb, 230, 225, 229), 0.95);
	backdrop-filter: blur(16px);
	-webkit-backdrop-filter: blur(16px);
}

/* ============================================
   SHIMMER ANIMATION ADJUSTMENTS
   Requirement: 20.3
   ============================================ */

/* Adjust shimmer colors for dark mode */
:root[data-theme="dark"] .mase-loading-shimmer,
.mase-dark-mode .mase-loading-shimmer {
	background: linear-gradient(
		90deg,
		var(--md-surface-variant) 0%,
		color-mix(in srgb, var(--md-surface-variant) 80%, white) 50%,
		var(--md-surface-variant) 100%
	);
}

/* Template card mini-bar shimmer */
:root[data-theme="dark"] .mase-template-minibar,
.mase-dark-mode .mase-template-minibar {
	background: rgba(255, 255, 255, 0.15);
}

/* Template card mini-menu items */
:root[data-theme="dark"] .mase-template-menuitem,
.mase-dark-mode .mase-template-menuitem {
	background: rgba(255, 255, 255, 0.12);
}

/* ============================================
   SHADOW ADJUSTMENTS
   Requirement: 20.3
   ============================================ */

/* Enhance shadow visibility on dark backgrounds */
:root[data-theme="dark"] .mase-template-card:hover,
.mase-dark-mode .mase-template-card:hover {
	box-shadow: 
		var(--md-elevation-3),
		0 0 0 1px rgba(255, 255, 255, 0.05);
}

/* Card elevation with subtle border for definition */
:root[data-theme="dark"] .mase-template-card,
.mase-dark-mode .mase-template-card {
	box-shadow: 
		var(--md-elevation-1),
		0 0 0 1px rgba(255, 255, 255, 0.03);
}

/* ============================================
   STATE LAYER ADJUSTMENTS
   Requirement: 20.3
   ============================================ */

/* Increase state layer visibility on dark surfaces */
:root[data-theme="dark"] .mase-nav-tab:hover::before,
.mase-dark-mode .mase-nav-tab:hover::before {
	opacity: 0.12;
}

:root[data-theme="dark"] .mase-nav-tab:focus::before,
.mase-dark-mode .mase-nav-tab:focus::before {
	opacity: 0.16;
}

/* Button state layers */
:root[data-theme="dark"] .mase-button-outlined:hover,
.mase-dark-mode .mase-button-outlined:hover {
	background: rgba(var(--md-primary-rgb), 0.12);
}

:root[data-theme="dark"] .mase-button-text:hover,
.mase-dark-mode .mase-button-text:hover {
	background: rgba(var(--md-primary-rgb), 0.12);
}

/* ============================================
   RIPPLE EFFECT ADJUSTMENTS
   Requirement: 20.3
   ============================================ */

/* Adjust ripple color for dark mode */
:root[data-theme="dark"] .mase-ripple,
.mase-dark-mode .mase-ripple {
	background: rgba(255, 255, 255, 0.3);
}

/* ============================================
   FOCUS INDICATORS
   Requirement: 20.3
   ============================================ */

/* Enhance focus visibility on dark backgrounds */
:root[data-theme="dark"] *:focus-visible,
.mase-dark-mode *:focus-visible {
	outline: 3px solid var(--md-primary);
	outline-offset: 2px;
}

/* ============================================
   BORDER ADJUSTMENTS
   Requirement: 20.3
   ============================================ */

/* Lighten borders for visibility on dark backgrounds */
:root[data-theme="dark"] .mase-template-card.active,
.mase-dark-mode .mase-template-card.active {
	outline: 3px solid var(--md-primary);
	outline-offset: -3px;
	box-shadow: 
		var(--md-elevation-1),
		0 0 0 1px rgba(255, 255, 255, 0.05),
		inset 0 0 0 3px var(--md-primary);
}

/* ============================================
   TEXT SHADOW ADJUSTMENTS
   Requirement: 20.3
   ============================================ */

/* Adjust text shadows for dark backgrounds */
:root[data-theme="dark"] .mase-admin-title,
.mase-dark-mode .mase-admin-title {
	text-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
}

/* ============================================
   LOADING STATES
   Requirement: 20.3
   ============================================ */

/* Adjust circular progress for dark mode */
:root[data-theme="dark"] .mase-progress-circular,
.mase-dark-mode .mase-progress-circular {
	border-color: rgba(var(--md-surface-variant-rgb, 73, 69, 79), 0.3);
	border-top-color: var(--md-primary);
}

/* ============================================
   FORM CONTROLS
   Requirement: 20.3, 20.4
   ============================================ */

/* Adjust color picker gradient for dark mode */
:root[data-theme="dark"] .mase-color-picker,
.mase-dark-mode .mase-color-picker {
	background: linear-gradient(
		45deg,
		color-mix(in srgb, #ff6b6b 90%, black) 0%,
		color-mix(in srgb, #ffd93d 90%, black) 16.67%,
		color-mix(in srgb, #6bcf7f 90%, black) 33.33%,
		color-mix(in srgb, #4d96ff 90%, black) 50%,
		color-mix(in srgb, #9c88ff 90%, black) 66.67%,
		color-mix(in srgb, #ff6b6b 90%, black) 100%
	);
	box-shadow: 
		var(--md-elevation-2),
		inset 0 0 0 1px rgba(255, 255, 255, 0.1);
}

/* Toggle switch adjustments */
:root[data-theme="dark"] .mase-toggle,
.mase-dark-mode .mase-toggle {
	background: var(--md-surface-variant);
	border-color: rgba(255, 255, 255, 0.2);
}

:root[data-theme="dark"] .mase-toggle.active,
.mase-dark-mode .mase-toggle.active {
	background: var(--md-primary);
	border-color: var(--md-primary);
	box-shadow: 0 0 12px rgba(var(--md-primary-rgb), 0.4);
}

/* Text field adjustments */
:root[data-theme="dark"] .mase-text-field input,
.mase-dark-mode .mase-text-field input {
	border-color: rgba(255, 255, 255, 0.2);
	background: rgba(var(--md-surface-rgb), 0.5);
}

:root[data-theme="dark"] .mase-text-field input:focus,
.mase-dark-mode .mase-text-field input:focus {
	border-color: var(--md-primary);
	background: var(--md-surface);
	box-shadow: 0 0 0 1px var(--md-primary);
}

/* ============================================
   MICRO-INTERACTIONS
   Requirement: 20.3
   ============================================ */

/* Adjust icon hover glow */
:root[data-theme="dark"] .mase-icon-hover:hover,
.mase-dark-mode .mase-icon-hover:hover {
	filter: drop-shadow(0 0 8px rgba(var(--md-primary-rgb), 0.5));
}

/* Success animation glow */
:root[data-theme="dark"] .mase-success-animation,
.mase-dark-mode .mase-success-animation {
	filter: drop-shadow(0 0 16px rgba(76, 175, 80, 0.6));
}

/* ============================================
   SCRIM OVERLAY
   Requirement: 20.3
   ============================================ */

/* Darker scrim for dark mode */
:root[data-theme="dark"] .md-scrim,
.mase-dark-mode .md-scrim {
	background: rgba(0, 0, 0, 0.64);
}

/* ============================================
   RESPONSIVE ADJUSTMENTS
   ============================================ */

@media (max-width: 768px) {
	/* Reduce glow effects on mobile for performance */
	:root[data-theme="dark"] .mase-button-filled:hover,
	.mase-dark-mode .mase-button-filled:hover {
		box-shadow: var(--md-elevation-2);
	}
	
	:root[data-theme="dark"] .mase-fab:hover,
	.mase-dark-mode .mase-fab:hover {
		box-shadow: var(--md-elevation-4);
	}
}

/* ============================================
   REDUCED MOTION SUPPORT
   ============================================ */

@media (prefers-reduced-motion: reduce) {
	:root[data-theme="dark"] .mase-loading-shimmer,
	.mase-dark-mode .mase-loading-shimmer {
		animation: none;
		background: var(--md-surface-variant);
	}
}

/* ============================================
   HIGH CONTRAST MODE SUPPORT
   ============================================ */

@media (prefers-contrast: high) {
	:root[data-theme="dark"] .mase-template-card,
	.mase-dark-mode .mase-template-card {
		border: 2px solid var(--md-outline);
	}
	
	:root[data-theme="dark"] .mase-template-card.active,
	.mase-dark-mode .mase-template-card.active {
		border: 3px solid var(--md-primary);
	}
}

/* ============================================
   FALLBACK FOR OLDER BROWSERS
   ============================================ */

/* Fallback for browsers without color-mix support */
@supports not (background: color-mix(in srgb, red, blue)) {
	:root[data-theme="dark"] .mase-md3-header,
	.mase-dark-mode .mase-md3-header {
		background: linear-gradient(
			135deg,
			var(--md-primary) 0%,
			var(--md-tertiary) 100%
		);
		filter: brightness(0.85);
	}
	
	:root[data-theme="dark"] .mase-template-header,
	.mase-dark-mode .mase-template-header {
		filter: brightness(0.8);
	}
	
	:root[data-theme="dark"] .mase-color-picker,
	.mase-dark-mode .mase-color-picker {
		filter: brightness(0.9);
	}
}

