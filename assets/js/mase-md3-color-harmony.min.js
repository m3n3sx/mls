/* mase-md3-color-harmony.js - Minified for production */
!function($){"use strict";const t={init:function(){this.$container=$(".mase-color-harmony"),0!==this.$container.length&&(this.colorInputs={},this.initColorInputs(),this.renderColorGroups(),this.bindEvents(),console.log("[MASE Color Harmony] Initialized"))},initColorInputs:function(){const t={primary:"admin_bar_bg_color",secondary:"menu_bg_color",tertiary:"admin_bar_text_color",surface:"content_bg_color",error:"#ba1a1a"};for(const[a,o]of Object.entries(t))if(o.startsWith("#"))this.colorInputs[a]={value:o,isStatic:!0};else{const t=$(`#${o}`);t.length>0&&(this.colorInputs[a]={$element:t,value:t.val()||"#6750a4",isStatic:!1})}},renderColorGroups:function(){this.$container.empty(),["primary","secondary","tertiary"].forEach(t=>{if(this.colorInputs[t]){const a=this.createColorGroup(t);this.$container.append(a)}})},createColorGroup:function(t){const a=this.getColorValue(t),o=this.generateContainerColor(a),n=this.getOnColor(a),s=this.getOnColor(o);return $(`\n\t\t\t\t<div class="mase-color-group" data-role="${t}">\n\t\t\t\t\t<div class="mase-color-group-header">\n\t\t\t\t\t\t<h3 class="mase-color-group-title">${this.formatRoleName(t)}</h3>\n\t\t\t\t\t\t<p class="mase-color-group-subtitle">Main color and container variant</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="mase-color-swatches">\n\t\t\t\t\t\t${this.createColorSwatch(t,a,n,!1)}\n\t\t\t\t\t\t${this.createColorSwatch(t+"-container",o,s,!0)}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.createContrastInfo(a,n,o,s)}\n\t\t\t\t</div>\n\t\t\t`)},createColorSwatch:function(t,a,o,n){return`\n\t\t\t\t<div class="mase-color-swatch ${n?"mase-color-swatch-container":""}" data-role="${t}">\n\t\t\t\t\t<div class="mase-color-swatch-content" style="background-color: ${a}; color: ${o};">\n\t\t\t\t\t\t<div class="mase-color-label">${n?"Container":"Main"}</div>\n\t\t\t\t\t\t<div class="mase-color-value">${a.toUpperCase()}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`},createContrastInfo:function(t,a,o,n){const s=this.calculateContrastRatio(t,a),e=this.calculateContrastRatio(o,n),r=this.getContrastStatus(s),i=this.getContrastStatus(e);return`\n\t\t\t\t<div class="mase-contrast-info">\n\t\t\t\t\t<div class="mase-contrast-ratio">\n\t\t\t\t\t\t<span class="mase-contrast-ratio-label">Main Contrast:</span>\n\t\t\t\t\t\t<span class="mase-contrast-ratio-value ${r.class}">${s.toFixed(2)}:1</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="mase-contrast-badge ${r.class}">\n\t\t\t\t\t\t<span class="dashicons ${r.icon}"></span>\n\t\t\t\t\t\t${r.label}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="mase-contrast-ratio" style="margin-top: 8px;">\n\t\t\t\t\t\t<span class="mase-contrast-ratio-label">Container Contrast:</span>\n\t\t\t\t\t\t<span class="mase-contrast-ratio-value ${i.class}">${e.toFixed(2)}:1</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="mase-contrast-badge ${i.class}">\n\t\t\t\t\t\t<span class="dashicons ${i.icon}"></span>\n\t\t\t\t\t\t${i.label}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class="mase-text-samples">\n\t\t\t\t\t\t<div class="mase-text-sample" style="background-color: ${t}; color: ${a};">\n\t\t\t\t\t\t\t<div class="mase-text-sample-label">Sample text on main</div>\n\t\t\t\t\t\t\t<div class="mase-text-sample-text">The quick brown fox jumps</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="mase-text-sample" style="background-color: ${o}; color: ${n};">\n\t\t\t\t\t\t\t<div class="mase-text-sample-label">Sample text on container</div>\n\t\t\t\t\t\t\t<div class="mase-text-sample-text">The quick brown fox jumps</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`},bindEvents:function(){const t=this;Object.keys(this.colorInputs).forEach(a=>{const o=this.colorInputs[a];!o.isStatic&&o.$element&&o.$element.on("change input",function(){t.updateColorGroup(a,$(this).val())})}),$(document).on("mase:palette:applied",function(a,o){t.handlePaletteChange(o)}),$(document).on("mase:template:applied",function(a,o){t.handleTemplateChange(o)})},updateColorGroup:function(t,a){const o=$(`.mase-color-group[data-role="${t}"]`);if(0===o.length)return;this.colorInputs[t]&&(this.colorInputs[t].value=a),o.find(".mase-color-swatch").addClass("updating"),o.find(".mase-contrast-info").addClass("updating");const n=this.generateContainerColor(a),s=this.getOnColor(a),e=this.getOnColor(n),r=o.find(`.mase-color-swatch[data-role="${t}"]`);r.find(".mase-color-swatch-content").css({"background-color":a,color:s}),r.find(".mase-color-value").text(a.toUpperCase());const i=o.find(`.mase-color-swatch[data-role="${t}-container"]`);i.find(".mase-color-swatch-content").css({"background-color":n,color:e}),i.find(".mase-color-value").text(n.toUpperCase()),this.updateContrastInfo(o,a,s,n,e),setTimeout(function(){o.find(".mase-color-swatch").removeClass("updating"),o.find(".mase-contrast-info").removeClass("updating")},400),console.log(`[MASE Color Harmony] Updated ${t} to ${a}`)},updateContrastInfo:function(t,a,o,n,s){const e=this.calculateContrastRatio(a,o),r=this.calculateContrastRatio(n,s),i=this.getContrastStatus(e),c=this.getContrastStatus(r);t.find(".mase-contrast-ratio:first .mase-contrast-ratio-value").text(`${e.toFixed(2)}:1`).removeClass("pass fail").addClass(i.class),t.find(".mase-contrast-badge:first").removeClass("wcag-aa wcag-aaa fail").addClass(i.class).html(`<span class="dashicons ${i.icon}"></span>${i.label}`),t.find(".mase-contrast-ratio:last .mase-contrast-ratio-value").text(`${r.toFixed(2)}:1`).removeClass("pass fail").addClass(c.class),t.find(".mase-contrast-badge:last").removeClass("wcag-aa wcag-aaa fail").addClass(c.class).html(`<span class="dashicons ${c.icon}"></span>${c.label}`);const l=t.find(".mase-text-sample");l.eq(0).css({"background-color":a,color:o}),l.eq(1).css({"background-color":n,color:s})},handlePaletteChange:function(t){this.initColorInputs(),this.renderColorGroups(),console.log("[MASE Color Harmony] Updated for palette change")},handleTemplateChange:function(t){this.initColorInputs(),this.renderColorGroups(),console.log("[MASE Color Harmony] Updated for template change")},getColorValue:function(t){const a=this.colorInputs[t];return a?a.isStatic?a.value:a.$element?a.$element.val():a.value:"#6750a4"},generateContainerColor:function(t){const a=this.hexToRgb(t);if(!a)return t;const o=Math.min(255,Math.round(a.r+.7*(255-a.r))),n=Math.min(255,Math.round(a.g+.7*(255-a.g))),s=Math.min(255,Math.round(a.b+.7*(255-a.b)));return this.rgbToHex(o,n,s)},getOnColor:function(t){const a=this.hexToRgb(t);return a?this.getRelativeLuminance(a.r,a.g,a.b)>.5?"#000000":"#ffffff":"#000000"},calculateContrastRatio:function(t,a){const o=this.hexToRgb(t),n=this.hexToRgb(a);if(!o||!n)return 1;const s=this.getRelativeLuminance(o.r,o.g,o.b),e=this.getRelativeLuminance(n.r,n.g,n.b);return(Math.max(s,e)+.05)/(Math.min(s,e)+.05)},getContrastStatus:function(t){return t>=7?{class:"wcag-aaa",label:"WCAG AAA",icon:"dashicons-yes-alt"}:t>=4.5?{class:"wcag-aa",label:"WCAG AA",icon:"dashicons-yes"}:{class:"fail",label:"Below WCAG",icon:"dashicons-warning"}},getRelativeLuminance:function(t,a,o){const n=t/255,s=a/255,e=o/255;return.2126*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.7152*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))+.0722*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))},hexToRgb:function(t){const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},rgbToHex:function(t,a,o){return"#"+[t,a,o].map(t=>{const a=t.toString(16);return 1===a.length?"0"+a:a}).join("")},formatRoleName:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}};$(document).ready(function(){$(".mase-settings-wrap").length>0&&t.init()}),window.MaseColorHarmony=t}(jQuery);